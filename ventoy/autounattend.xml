<?xml version="1.0" encoding="utf-8"?>
<unattend xmlns="urn:schemas-microsoft-com:unattend" xmlns:wcm="http://schemas.microsoft.com/WMIConfig/2002/State">
<!-- Shivaay (Optimised for Power Users) -->
<!-- Modified by FlaxCube Gaming / ShivamXD6 -->
<!-- Credits to MemoryTechTips, Atlas, ChrisTitusTech and Revi for Tweaks used in this answer File -->

<!-- 1+ Pre-Installation (Offline Updates & Windows PE Setup) -->
 <settings pass="offlineServicing"></settings>
 <settings pass="windowsPE">
  <component name="Microsoft-Windows-Setup" processorArchitecture="x86" publicKeyToken="31bf3856ad364e35" language="neutral" versionScope="nonSxS">
   <UserData>
    <ProductKey>
     <Key>00000-00000-00000-00000-00000</Key>
     <WillShowUI>Always</WillShowUI>
    </ProductKey>
    <AcceptEula>true</AcceptEula>
   </UserData>
   <RunSynchronous>
<!-- Bypass Windows 11 System Requirements -->
    <RunSynchronousCommand wcm:action="add">
     <Order>1</Order>
     <Path>reg add "HKLM\SYSTEM\Setup\LabConfig" /v BypassTPMCheck /t REG_DWORD /d 1 /f</Path>
    </RunSynchronousCommand>
    <RunSynchronousCommand wcm:action="add">
     <Order>2</Order>
     <Path>reg add "HKLM\SYSTEM\Setup\LabConfig" /v BypassSecureBootCheck /t REG_DWORD /d 1 /f</Path>
    </RunSynchronousCommand>
    <RunSynchronousCommand wcm:action="add">
     <Order>3</Order>
     <Path>reg add "HKLM\SYSTEM\Setup\LabConfig" /v BypassStorageCheck /t REG_DWORD /d 1 /f</Path>
    </RunSynchronousCommand>
    <RunSynchronousCommand wcm:action="add">
     <Order>4</Order>
     <Path>reg add "HKLM\SYSTEM\Setup\LabConfig" /v BypassCPUCheck /t REG_DWORD /d 1 /f</Path>
    </RunSynchronousCommand>
    <RunSynchronousCommand wcm:action="add">
     <Order>5</Order>
     <Path>reg add "HKLM\SYSTEM\Setup\LabConfig" /v BypassRAMCheck /t REG_DWORD /d 1 /f</Path>
    </RunSynchronousCommand>
    <RunSynchronousCommand wcm:action="add">
     <Order>6</Order>
     <Path>reg add "HKLM\SYSTEM\Setup\LabConfig" /v BypassDiskCheck /t REG_DWORD /d 1 /f</Path>
    </RunSynchronousCommand>
<!--Prevent auto detection of Windows Edition-->
    <RunSynchronousCommand wcm:action="add">
     <Order>7</Order>
     <Path>cmd /c del /f /q X:\Sources\ei.cfg</Path>
    </RunSynchronousCommand>
    <RunSynchronousCommand wcm:action="add">
     <Order>8</Order>
     <Path>cmd /c echo [Channel] > X:\Sources\ei.cfg</Path>
    </RunSynchronousCommand>
    <RunSynchronousCommand wcm:action="add">
     <Order>9</Order>
     <Path>cmd /c echo _Default >> X:\Sources\ei.cfg</Path>
    </RunSynchronousCommand>
    <RunSynchronousCommand wcm:action="add">
     <Order>10</Order>
     <Path>cmd /c echo [VL] >> X:\Sources\ei.cfg</Path>
    </RunSynchronousCommand>
    <RunSynchronousCommand wcm:action="add">
     <Order>11</Order>
     <Path>cmd /c echo 0 >> X:\Sources\ei.cfg</Path>
    </RunSynchronousCommand>
<!--Disable Defender-->
    <RunSynchronousCommand wcm:action="add">
     <Order>12</Order>
     <Path>cmd /c "&gt;&gt;"X:\disable-defender.cmd" echo @ECHO OFF"</Path>
    </RunSynchronousCommand>
    <RunSynchronousCommand wcm:action="add">
     <Order>13</Order>
     <Path>cmd /c "&gt;&gt;"X:\disable-defender.cmd" echo SET file=C:\$Windows.~BT\NewOS\Windows\System32\config\SYSTEM"</Path>
    </RunSynchronousCommand>
    <RunSynchronousCommand wcm:action="add">
     <Order>14</Order>
     <Path>cmd /c "&gt;&gt;"X:\disable-defender.cmd" echo FOR /L ^%^%i IN (0) DO ("</Path>
    </RunSynchronousCommand>
    <RunSynchronousCommand wcm:action="add">
     <Order>15</Order>
     <Path>cmd /c "&gt;&gt;"X:\disable-defender.cmd" echo CALL :sleep"</Path>
    </RunSynchronousCommand>
    <RunSynchronousCommand wcm:action="add">
     <Order>16</Order>
     <Path>cmd /c "&gt;&gt;"X:\disable-defender.cmd" echo IF EXIST ^%file^% ("</Path>
    </RunSynchronousCommand>
    <RunSynchronousCommand wcm:action="add">
     <Order>17</Order>
     <Path>cmd /c "&gt;&gt;"X:\disable-defender.cmd" echo CALL :load"</Path>
    </RunSynchronousCommand>
    <RunSynchronousCommand wcm:action="add">
     <Order>18</Order>
     <Path>cmd /c "&gt;&gt;"X:\disable-defender.cmd" echo FOR ^%^%s IN (Sense WdBoot WdFilter WdNisDrv WdNisSvc WinDefend MDCoreSvc) DO reg ADD HKLM\mount\ControlSet001\Services\^%^%s /v Start /t REG_DWORD /d 4 /f"</Path>
    </RunSynchronousCommand>
    <RunSynchronousCommand wcm:action="add">
     <Order>19</Order>
     <Path>cmd /c "&gt;&gt;"X:\disable-defender.cmd" echo reg UNLOAD HKLM\mount"</Path>
    </RunSynchronousCommand>
    <RunSynchronousCommand wcm:action="add">
     <Order>20</Order>
     <Path>cmd /c "&gt;&gt;"X:\disable-defender.cmd" echo EXIT ) )"</Path>
    </RunSynchronousCommand>
    <RunSynchronousCommand wcm:action="add">
     <Order>21</Order>
     <Path>cmd /c "&gt;&gt;"X:\disable-defender.cmd" echo GOTO :eof"</Path>
    </RunSynchronousCommand>
    <RunSynchronousCommand wcm:action="add">
     <Order>22</Order>
     <Path>cmd /c "&gt;&gt;"X:\disable-defender.cmd" echo :load"</Path>
    </RunSynchronousCommand>
    <RunSynchronousCommand wcm:action="add">
     <Order>23</Order>
     <Path>cmd /c "&gt;&gt;"X:\disable-defender.cmd" echo reg LOAD HKLM\mount ^%file^%"</Path>
    </RunSynchronousCommand>
    <RunSynchronousCommand wcm:action="add">
     <Order>24</Order>
     <Path>cmd /c "&gt;&gt;"X:\disable-defender.cmd" echo IF ^%errorlevel^% GTR 0 GOTO load"</Path>
    </RunSynchronousCommand>
    <RunSynchronousCommand wcm:action="add">
     <Order>25</Order>
     <Path>cmd /c "&gt;&gt;"X:\disable-defender.cmd" echo GOTO :eof"</Path>
    </RunSynchronousCommand>
    <RunSynchronousCommand wcm:action="add">
     <Order>26</Order>
     <Path>cmd /c "&gt;&gt;"X:\disable-defender.cmd" echo :sleep"</Path>
    </RunSynchronousCommand>
    <RunSynchronousCommand wcm:action="add">
     <Order>27</Order>
     <Path>cmd /c "&gt;&gt;"X:\disable-defender.cmd" echo ping -n 1 127.0.0.1 ^&gt; NUL"</Path>
    </RunSynchronousCommand>
    <RunSynchronousCommand wcm:action="add">
     <Order>28</Order>
     <Path>cmd /c "&gt;&gt;"X:\disable-defender.cmd" echo GOTO :eof"</Path>
    </RunSynchronousCommand>
    <RunSynchronousCommand wcm:action="add">
     <Order>29</Order>
     <Path>cmd /c "start /MIN X:\disable-defender.cmd"</Path>
    </RunSynchronousCommand>
   </RunSynchronous>
  </component>
  <component name="Microsoft-Windows-Setup" processorArchitecture="arm64" publicKeyToken="31bf3856ad364e35" language="neutral" versionScope="nonSxS">
   <UserData>
    <ProductKey>
     <Key>00000-00000-00000-00000-00000</Key>
     <WillShowUI>Always</WillShowUI>
    </ProductKey>
    <AcceptEula>true</AcceptEula>
   </UserData>
   <RunSynchronous>
    <RunSynchronousCommand wcm:action="add">
     <Order>1</Order>
     <Path>reg add "HKLM\SYSTEM\Setup\LabConfig" /v BypassTPMCheck /t REG_DWORD /d 1 /f</Path>
    </RunSynchronousCommand>
    <RunSynchronousCommand wcm:action="add">
     <Order>2</Order>
     <Path>reg add "HKLM\SYSTEM\Setup\LabConfig" /v BypassSecureBootCheck /t REG_DWORD /d 1 /f</Path>
    </RunSynchronousCommand>
    <RunSynchronousCommand wcm:action="add">
     <Order>3</Order>
     <Path>reg add "HKLM\SYSTEM\Setup\LabConfig" /v BypassStorageCheck /t REG_DWORD /d 1 /f</Path>
    </RunSynchronousCommand>
    <RunSynchronousCommand wcm:action="add">
     <Order>4</Order>
     <Path>reg add "HKLM\SYSTEM\Setup\LabConfig" /v BypassCPUCheck /t REG_DWORD /d 1 /f</Path>
    </RunSynchronousCommand>
    <RunSynchronousCommand wcm:action="add">
     <Order>5</Order>
     <Path>reg add "HKLM\SYSTEM\Setup\LabConfig" /v BypassRAMCheck /t REG_DWORD /d 1 /f</Path>
    </RunSynchronousCommand>
    <RunSynchronousCommand wcm:action="add">
     <Order>6</Order>
     <Path>reg add "HKLM\SYSTEM\Setup\LabConfig" /v BypassDiskCheck /t REG_DWORD /d 1 /f</Path>
    </RunSynchronousCommand>
    <RunSynchronousCommand wcm:action="add">
     <Order>7</Order>
     <Path>cmd /c del /f /q X:\Sources\ei.cfg</Path>
    </RunSynchronousCommand>
    <RunSynchronousCommand wcm:action="add">
     <Order>8</Order>
     <Path>cmd /c echo [Channel] > X:\Sources\ei.cfg</Path>
    </RunSynchronousCommand>
    <RunSynchronousCommand wcm:action="add">
     <Order>9</Order>
     <Path>cmd /c echo _Default >> X:\Sources\ei.cfg</Path>
    </RunSynchronousCommand>
    <RunSynchronousCommand wcm:action="add">
     <Order>10</Order>
     <Path>cmd /c echo [VL] >> X:\Sources\ei.cfg</Path>
    </RunSynchronousCommand>
    <RunSynchronousCommand wcm:action="add">
     <Order>11</Order>
     <Path>cmd /c echo 0 >> X:\Sources\ei.cfg</Path>
    </RunSynchronousCommand>
    <RunSynchronousCommand wcm:action="add">
     <Order>12</Order>
     <Path>cmd /c "&gt;&gt;"X:\disable-defender.cmd" echo @ECHO OFF"</Path>
    </RunSynchronousCommand>
    <RunSynchronousCommand wcm:action="add">
     <Order>13</Order>
     <Path>cmd /c "&gt;&gt;"X:\disable-defender.cmd" echo SET file=C:\$Windows.~BT\NewOS\Windows\System32\config\SYSTEM"</Path>
    </RunSynchronousCommand>
    <RunSynchronousCommand wcm:action="add">
     <Order>14</Order>
     <Path>cmd /c "&gt;&gt;"X:\disable-defender.cmd" echo FOR /L ^%^%i IN (0) DO ("</Path>
    </RunSynchronousCommand>
    <RunSynchronousCommand wcm:action="add">
     <Order>15</Order>
     <Path>cmd /c "&gt;&gt;"X:\disable-defender.cmd" echo CALL :sleep"</Path>
    </RunSynchronousCommand>
    <RunSynchronousCommand wcm:action="add">
     <Order>16</Order>
     <Path>cmd /c "&gt;&gt;"X:\disable-defender.cmd" echo IF EXIST ^%file^% ("</Path>
    </RunSynchronousCommand>
    <RunSynchronousCommand wcm:action="add">
     <Order>17</Order>
     <Path>cmd /c "&gt;&gt;"X:\disable-defender.cmd" echo CALL :load"</Path>
    </RunSynchronousCommand>
    <RunSynchronousCommand wcm:action="add">
     <Order>18</Order>
     <Path>cmd /c "&gt;&gt;"X:\disable-defender.cmd" echo FOR ^%^%s IN (Sense WdBoot WdFilter WdNisDrv WdNisSvc WinDefend MDCoreSvc) DO reg ADD HKLM\mount\ControlSet001\Services\^%^%s /v Start /t REG_DWORD /d 4 /f"</Path>
    </RunSynchronousCommand>
    <RunSynchronousCommand wcm:action="add">
     <Order>19</Order>
     <Path>cmd /c "&gt;&gt;"X:\disable-defender.cmd" echo reg UNLOAD HKLM\mount"</Path>
    </RunSynchronousCommand>
    <RunSynchronousCommand wcm:action="add">
     <Order>20</Order>
     <Path>cmd /c "&gt;&gt;"X:\disable-defender.cmd" echo EXIT ) )"</Path>
    </RunSynchronousCommand>
    <RunSynchronousCommand wcm:action="add">
     <Order>21</Order>
     <Path>cmd /c "&gt;&gt;"X:\disable-defender.cmd" echo GOTO :eof"</Path>
    </RunSynchronousCommand>
    <RunSynchronousCommand wcm:action="add">
     <Order>22</Order>
     <Path>cmd /c "&gt;&gt;"X:\disable-defender.cmd" echo :load"</Path>
    </RunSynchronousCommand>
    <RunSynchronousCommand wcm:action="add">
     <Order>23</Order>
     <Path>cmd /c "&gt;&gt;"X:\disable-defender.cmd" echo reg LOAD HKLM\mount ^%file^%"</Path>
    </RunSynchronousCommand>
    <RunSynchronousCommand wcm:action="add">
     <Order>24</Order>
     <Path>cmd /c "&gt;&gt;"X:\disable-defender.cmd" echo IF ^%errorlevel^% GTR 0 GOTO load"</Path>
    </RunSynchronousCommand>
    <RunSynchronousCommand wcm:action="add">
     <Order>25</Order>
     <Path>cmd /c "&gt;&gt;"X:\disable-defender.cmd" echo GOTO :eof"</Path>
    </RunSynchronousCommand>
    <RunSynchronousCommand wcm:action="add">
     <Order>26</Order>
     <Path>cmd /c "&gt;&gt;"X:\disable-defender.cmd" echo :sleep"</Path>
    </RunSynchronousCommand>
    <RunSynchronousCommand wcm:action="add">
     <Order>27</Order>
     <Path>cmd /c "&gt;&gt;"X:\disable-defender.cmd" echo ping -n 1 127.0.0.1 ^&gt; NUL"</Path>
    </RunSynchronousCommand>
    <RunSynchronousCommand wcm:action="add">
     <Order>28</Order>
     <Path>cmd /c "&gt;&gt;"X:\disable-defender.cmd" echo GOTO :eof"</Path>
    </RunSynchronousCommand>
    <RunSynchronousCommand wcm:action="add">
     <Order>29</Order>
     <Path>cmd /c "start /MIN X:\disable-defender.cmd"</Path>
    </RunSynchronousCommand>
   </RunSynchronous>
  </component>
  <component name="Microsoft-Windows-Setup" processorArchitecture="amd64" publicKeyToken="31bf3856ad364e35" language="neutral" versionScope="nonSxS">
   <UserData>
    <ProductKey>
     <Key>00000-00000-00000-00000-00000</Key>
     <WillShowUI>Always</WillShowUI>
    </ProductKey>
    <AcceptEula>true</AcceptEula>
   </UserData>
   <RunSynchronous>
    <RunSynchronousCommand wcm:action="add">
     <Order>1</Order>
     <Path>reg add "HKLM\SYSTEM\Setup\LabConfig" /v BypassTPMCheck /t REG_DWORD /d 1 /f</Path>
    </RunSynchronousCommand>
    <RunSynchronousCommand wcm:action="add">
     <Order>2</Order>
     <Path>reg add "HKLM\SYSTEM\Setup\LabConfig" /v BypassSecureBootCheck /t REG_DWORD /d 1 /f</Path>
    </RunSynchronousCommand>
    <RunSynchronousCommand wcm:action="add">
     <Order>3</Order>
     <Path>reg add "HKLM\SYSTEM\Setup\LabConfig" /v BypassStorageCheck /t REG_DWORD /d 1 /f</Path>
    </RunSynchronousCommand>
    <RunSynchronousCommand wcm:action="add">
     <Order>4</Order>
     <Path>reg add "HKLM\SYSTEM\Setup\LabConfig" /v BypassCPUCheck /t REG_DWORD /d 1 /f</Path>
    </RunSynchronousCommand>
    <RunSynchronousCommand wcm:action="add">
     <Order>5</Order>
     <Path>reg add "HKLM\SYSTEM\Setup\LabConfig" /v BypassRAMCheck /t REG_DWORD /d 1 /f</Path>
    </RunSynchronousCommand>
    <RunSynchronousCommand wcm:action="add">
     <Order>6</Order>
     <Path>reg add "HKLM\SYSTEM\Setup\LabConfig" /v BypassDiskCheck /t REG_DWORD /d 1 /f</Path>
    </RunSynchronousCommand>
    <RunSynchronousCommand wcm:action="add">
     <Order>7</Order>
     <Path>cmd /c del /f /q X:\Sources\ei.cfg</Path>
    </RunSynchronousCommand>
    <RunSynchronousCommand wcm:action="add">
     <Order>8</Order>
     <Path>cmd /c echo [Channel] > X:\Sources\ei.cfg</Path>
    </RunSynchronousCommand>
    <RunSynchronousCommand wcm:action="add">
     <Order>9</Order>
     <Path>cmd /c echo _Default >> X:\Sources\ei.cfg</Path>
    </RunSynchronousCommand>
    <RunSynchronousCommand wcm:action="add">
     <Order>10</Order>
     <Path>cmd /c echo [VL] >> X:\Sources\ei.cfg</Path>
    </RunSynchronousCommand>
    <RunSynchronousCommand wcm:action="add">
     <Order>11</Order>
     <Path>cmd /c echo 0 >> X:\Sources\ei.cfg</Path>
    </RunSynchronousCommand>
    <RunSynchronousCommand wcm:action="add">
     <Order>12</Order>
     <Path>cmd /c "&gt;&gt;"X:\disable-defender.cmd" echo @ECHO OFF"</Path>
    </RunSynchronousCommand>
    <RunSynchronousCommand wcm:action="add">
     <Order>13</Order>
     <Path>cmd /c "&gt;&gt;"X:\disable-defender.cmd" echo SET file=C:\$Windows.~BT\NewOS\Windows\System32\config\SYSTEM"</Path>
    </RunSynchronousCommand>
    <RunSynchronousCommand wcm:action="add">
     <Order>14</Order>
     <Path>cmd /c "&gt;&gt;"X:\disable-defender.cmd" echo FOR /L ^%^%i IN (0) DO ("</Path>
    </RunSynchronousCommand>
    <RunSynchronousCommand wcm:action="add">
     <Order>15</Order>
     <Path>cmd /c "&gt;&gt;"X:\disable-defender.cmd" echo CALL :sleep"</Path>
    </RunSynchronousCommand>
    <RunSynchronousCommand wcm:action="add">
     <Order>16</Order>
     <Path>cmd /c "&gt;&gt;"X:\disable-defender.cmd" echo IF EXIST ^%file^% ("</Path>
    </RunSynchronousCommand>
    <RunSynchronousCommand wcm:action="add">
     <Order>17</Order>
     <Path>cmd /c "&gt;&gt;"X:\disable-defender.cmd" echo CALL :load"</Path>
    </RunSynchronousCommand>
    <RunSynchronousCommand wcm:action="add">
     <Order>18</Order>
     <Path>cmd /c "&gt;&gt;"X:\disable-defender.cmd" echo FOR ^%^%s IN (Sense WdBoot WdFilter WdNisDrv WdNisSvc WinDefend MDCoreSvc) DO reg ADD HKLM\mount\ControlSet001\Services\^%^%s /v Start /t REG_DWORD /d 4 /f"</Path>
    </RunSynchronousCommand>
    <RunSynchronousCommand wcm:action="add">
     <Order>19</Order>
     <Path>cmd /c "&gt;&gt;"X:\disable-defender.cmd" echo reg UNLOAD HKLM\mount"</Path>
    </RunSynchronousCommand>
    <RunSynchronousCommand wcm:action="add">
     <Order>20</Order>
     <Path>cmd /c "&gt;&gt;"X:\disable-defender.cmd" echo EXIT ) )"</Path>
    </RunSynchronousCommand>
    <RunSynchronousCommand wcm:action="add">
     <Order>21</Order>
     <Path>cmd /c "&gt;&gt;"X:\disable-defender.cmd" echo GOTO :eof"</Path>
    </RunSynchronousCommand>
    <RunSynchronousCommand wcm:action="add">
     <Order>22</Order>
     <Path>cmd /c "&gt;&gt;"X:\disable-defender.cmd" echo :load"</Path>
    </RunSynchronousCommand>
    <RunSynchronousCommand wcm:action="add">
     <Order>23</Order>
     <Path>cmd /c "&gt;&gt;"X:\disable-defender.cmd" echo reg LOAD HKLM\mount ^%file^%"</Path>
    </RunSynchronousCommand>
    <RunSynchronousCommand wcm:action="add">
     <Order>24</Order>
     <Path>cmd /c "&gt;&gt;"X:\disable-defender.cmd" echo IF ^%errorlevel^% GTR 0 GOTO load"</Path>
    </RunSynchronousCommand>
    <RunSynchronousCommand wcm:action="add">
     <Order>25</Order>
     <Path>cmd /c "&gt;&gt;"X:\disable-defender.cmd" echo GOTO :eof"</Path>
    </RunSynchronousCommand>
    <RunSynchronousCommand wcm:action="add">
     <Order>26</Order>
     <Path>cmd /c "&gt;&gt;"X:\disable-defender.cmd" echo :sleep"</Path>
    </RunSynchronousCommand>
    <RunSynchronousCommand wcm:action="add">
     <Order>27</Order>
     <Path>cmd /c "&gt;&gt;"X:\disable-defender.cmd" echo ping -n 1 127.0.0.1 ^&gt; NUL"</Path>
    </RunSynchronousCommand>
    <RunSynchronousCommand wcm:action="add">
     <Order>28</Order>
     <Path>cmd /c "&gt;&gt;"X:\disable-defender.cmd" echo GOTO :eof"</Path>
    </RunSynchronousCommand>
    <RunSynchronousCommand wcm:action="add">
     <Order>29</Order>
     <Path>cmd /c "start /MIN X:\disable-defender.cmd"</Path>
    </RunSynchronousCommand>
   </RunSynchronous>
  </component>
 </settings>

<!-- 2+ System Setup (Hardware Independence & System Configuration) -->
 <settings pass="generalize"></settings>
 <settings pass="specialize">
  <component name="Microsoft-Windows-Deployment" processorArchitecture="x86" publicKeyToken="31bf3856ad364e35" language="neutral" versionScope="nonSxS">
   <RunSynchronous>
<!-- Extracts and Executes Scripts in this XML File -->
    <RunSynchronousCommand wcm:action="add">
     <Order>1</Order>
     <Path>powershell.exe -NoProfile -WindowStyle Hidden -Command "$xml = [xml]::new(); $xml.Load('C:\Windows\Panther\unattend.xml'); $sb = [scriptblock]::Create( $xml.unattend.Extensions.ExtractScript ); Invoke-Command -ScriptBlock $sb -ArgumentList $xml;"</Path>
    </RunSynchronousCommand>
<!-- Executes the remove-packages Powershell Script -->
    <RunSynchronousCommand wcm:action="add">
     <Order>2</Order>
     <Path>powershell.exe -NoProfile -WindowStyle Hidden -ExecutionPolicy Bypass -Command "Get-Content -LiteralPath 'C:\Windows\Setup\Scripts\remove-packages.ps1' -Raw | Invoke-Expression;"</Path>
    </RunSynchronousCommand>
<!-- Run PowerShell Tweaks -->
    <RunSynchronousCommand wcm:action="add">
     <Order>3</Order>
     <Path>powershell.exe -NoProfile -WindowStyle Hidden -ExecutionPolicy Bypass -Command "Get-Content -LiteralPath 'C:\Windows\Setup\Scripts\wintweaks.ps1' -Raw | Invoke-Expression;"</Path>
    </RunSynchronousCommand>
<!-- Executes the HKLM Registry Entries Script -->
    <RunSynchronousCommand wcm:action="add">
     <Order>4</Order>
     <Path>cmd /c "C:\Windows\Setup\Scripts\localmachine.cmd &gt;&gt;"C:\Windows\Setup\Scripts\localmachine.log" 2&gt;&amp;1"</Path>
    </RunSynchronousCommand>
<!-- Adds Items to Right-Click Context Menu -->
    <RunSynchronousCommand wcm:action="add">
     <Order>5</Order>
     <Path>cmd /c "reg import "C:\Windows\Setup\Scripts\contextmenu.reg" &gt;&gt;"C:\Windows\Setup\Scripts\contextmenu.log" 2&gt;&amp;1"</Path>
    </RunSynchronousCommand>
<!-- Loads the Default User Registry Hive so Changes Can be Made to It -->
    <RunSynchronousCommand wcm:action="add">
     <Order>6</Order>
     <Path>reg load "HKU\DefaultUser" "C:\Users\Default\NTUSER.DAT"</Path>
    </RunSynchronousCommand>
<!-- Registry Entry to Execute the HKCU Registry Entry Script the First Time a New User Logs In -->
    <RunSynchronousCommand wcm:action="add">
     <Order>7</Order>
     <Path>reg add "HKU\DefaultUser\Software\Microsoft\Windows\CurrentVersion\Runonce" /v "currentuser" /t REG_SZ /d "C:\Windows\Setup\Scripts\currentuser.cmd" /f</Path>
    </RunSynchronousCommand>
<!-- Unloads the Default User Registry Hive -->
    <RunSynchronousCommand wcm:action="add">
     <Order>8</Order>
     <Path>reg unload "HKU\DefaultUser"</Path>
    </RunSynchronousCommand>
   </RunSynchronous>
  </component>
  <component name="Microsoft-Windows-Deployment" processorArchitecture="arm64" publicKeyToken="31bf3856ad364e35" language="neutral" versionScope="nonSxS">
   <RunSynchronous>
    <RunSynchronousCommand wcm:action="add">
     <Order>1</Order>
     <Path>powershell.exe -NoProfile -WindowStyle Hidden -Command "$xml = [xml]::new(); $xml.Load('C:\Windows\Panther\unattend.xml'); $sb = [scriptblock]::Create( $xml.unattend.Extensions.ExtractScript ); Invoke-Command -ScriptBlock $sb -ArgumentList $xml;"</Path>
    </RunSynchronousCommand>
    <RunSynchronousCommand wcm:action="add">
     <Order>2</Order>
     <Path>powershell.exe -NoProfile -WindowStyle Hidden -ExecutionPolicy Bypass -Command "Get-Content -LiteralPath 'C:\Windows\Setup\Scripts\remove-packages.ps1' -Raw | Invoke-Expression;"</Path>
    </RunSynchronousCommand>
    <RunSynchronousCommand wcm:action="add">
     <Order>3</Order>
     <Path>powershell.exe -NoProfile -WindowStyle Hidden -ExecutionPolicy Bypass -Command "Get-Content -LiteralPath 'C:\Windows\Setup\Scripts\wintweaks.ps1' -Raw | Invoke-Expression;"</Path>
    </RunSynchronousCommand>
    <RunSynchronousCommand wcm:action="add">
     <Order>4</Order>
     <Path>cmd /c "C:\Windows\Setup\Scripts\localmachine.cmd &gt;&gt;"C:\Windows\Setup\Scripts\localmachine.log" 2&gt;&amp;1"</Path>
    </RunSynchronousCommand>
    <RunSynchronousCommand wcm:action="add">
     <Order>5</Order>
     <Path>cmd /c "reg import "C:\Windows\Setup\Scripts\contextmenu.reg" &gt;&gt;"C:\Windows\Setup\Scripts\contextmenu.log" 2&gt;&amp;1"</Path>
    </RunSynchronousCommand>
    <RunSynchronousCommand wcm:action="add">
     <Order>6</Order>
     <Path>reg load "HKU\DefaultUser" "C:\Users\Default\NTUSER.DAT"</Path>
    </RunSynchronousCommand>
    <RunSynchronousCommand wcm:action="add">
     <Order>7</Order>
     <Path>reg add "HKU\DefaultUser\Software\Microsoft\Windows\CurrentVersion\Runonce" /v "currentuser" /t REG_SZ /d "C:\Windows\Setup\Scripts\currentuser.cmd" /f</Path>
    </RunSynchronousCommand>
    <RunSynchronousCommand wcm:action="add">
     <Order>8</Order>
     <Path>reg unload "HKU\DefaultUser"</Path>
    </RunSynchronousCommand>
   </RunSynchronous>
  </component>
  <component name="Microsoft-Windows-Deployment" processorArchitecture="amd64" publicKeyToken="31bf3856ad364e35" language="neutral" versionScope="nonSxS">
   <RunSynchronous>
    <RunSynchronousCommand wcm:action="add">
     <Order>1</Order>
     <Path>powershell.exe -NoProfile -WindowStyle Hidden -Command "$xml = [xml]::new(); $xml.Load('C:\Windows\Panther\unattend.xml'); $sb = [scriptblock]::Create( $xml.unattend.Extensions.ExtractScript ); Invoke-Command -ScriptBlock $sb -ArgumentList $xml;"</Path>
    </RunSynchronousCommand>
    <RunSynchronousCommand wcm:action="add">
     <Order>2</Order>
     <Path>powershell.exe -NoProfile -WindowStyle Hidden -ExecutionPolicy Bypass -Command "Get-Content -LiteralPath 'C:\Windows\Setup\Scripts\remove-packages.ps1' -Raw | Invoke-Expression;"</Path>
    </RunSynchronousCommand>
    <RunSynchronousCommand wcm:action="add">
     <Order>3</Order>
     <Path>powershell.exe -NoProfile -WindowStyle Hidden -ExecutionPolicy Bypass -Command "Get-Content -LiteralPath 'C:\Windows\Setup\Scripts\wintweaks.ps1' -Raw | Invoke-Expression;"</Path>
    </RunSynchronousCommand>
    <RunSynchronousCommand wcm:action="add">
     <Order>4</Order>
     <Path>cmd /c "C:\Windows\Setup\Scripts\localmachine.cmd &gt;&gt;"C:\Windows\Setup\Scripts\localmachine.log" 2&gt;&amp;1"</Path>
    </RunSynchronousCommand>
    <RunSynchronousCommand wcm:action="add">
     <Order>5</Order>
     <Path>cmd /c "reg import "C:\Windows\Setup\Scripts\contextmenu.reg" &gt;&gt;"C:\Windows\Setup\Scripts\contextmenu.log" 2&gt;&amp;1"</Path>
    </RunSynchronousCommand>
    <RunSynchronousCommand wcm:action="add">
     <Order>6</Order>
     <Path>reg load "HKU\DefaultUser" "C:\Users\Default\NTUSER.DAT"</Path>
    </RunSynchronousCommand>
    <RunSynchronousCommand wcm:action="add">
     <Order>7</Order>
     <Path>reg add "HKU\DefaultUser\Software\Microsoft\Windows\CurrentVersion\Runonce" /v "currentuser" /t REG_SZ /d "C:\Windows\Setup\Scripts\currentuser.cmd" /f</Path>
    </RunSynchronousCommand>
    <RunSynchronousCommand wcm:action="add">
     <Order>8</Order>
     <Path>reg unload "HKU\DefaultUser"</Path>
    </RunSynchronousCommand>
   </RunSynchronous>
  </component>
 </settings>

<!-- 3+ Post-Installation (Audit & OOBE Configuration) -->
 <settings pass="auditSystem"></settings>
 <settings pass="auditUser"></settings>
 <settings pass="oobeSystem">
  <component name="Microsoft-Windows-Shell-Setup" processorArchitecture="x86" publicKeyToken="31bf3856ad364e35" language="neutral" versionScope="nonSxS">
   <OOBE>
    <HideEULAPage>true</HideEULAPage>
    <HideOEMRegistrationScreen>true</HideOEMRegistrationScreen>
    <HideOnlineAccountScreens>true</HideOnlineAccountScreens>
    <HideWirelessSetupInOOBE>true</HideWirelessSetupInOOBE>
    <NetworkLocation>Work</NetworkLocation>
    <ProtectYourPC>3</ProtectYourPC>
   </OOBE>
   <FirstLogonCommands></FirstLogonCommands>
  </component>
  <component name="Microsoft-Windows-Shell-Setup" processorArchitecture="arm64" publicKeyToken="31bf3856ad364e35" language="neutral" versionScope="nonSxS">
   <OOBE>
    <HideEULAPage>true</HideEULAPage>
    <HideOEMRegistrationScreen>true</HideOEMRegistrationScreen>
    <HideOnlineAccountScreens>true</HideOnlineAccountScreens>
    <HideWirelessSetupInOOBE>true</HideWirelessSetupInOOBE>
    <NetworkLocation>Work</NetworkLocation>
    <ProtectYourPC>3</ProtectYourPC>
   </OOBE>
   <FirstLogonCommands></FirstLogonCommands>
  </component>
  <component name="Microsoft-Windows-Shell-Setup" processorArchitecture="amd64" publicKeyToken="31bf3856ad364e35" language="neutral" versionScope="nonSxS">
   <OOBE>
    <HideEULAPage>true</HideEULAPage>
    <HideOEMRegistrationScreen>true</HideOEMRegistrationScreen>
    <HideOnlineAccountScreens>true</HideOnlineAccountScreens>
    <HideWirelessSetupInOOBE>true</HideWirelessSetupInOOBE>
    <NetworkLocation>Work</NetworkLocation>
    <ProtectYourPC>3</ProtectYourPC>
   </OOBE>
   <FirstLogonCommands></FirstLogonCommands>
  </component>
 </settings>

<!-- 4+ Windows Extensions (To run the CMD or Powershell) -->
 <Extensions>
  <ExtractScript>
param(
    [xml] $Document
);

$scriptsDir = 'C:\Windows\Setup\Scripts\';
foreach( $file in $Document.unattend.Extensions.File ) {
    $path = [System.Environment]::ExpandEnvironmentVariables(
        $file.GetAttribute( 'path' )
    );
    if( $path.StartsWith( $scriptsDir ) ) {
        mkdir -Path $scriptsDir -ErrorAction 'SilentlyContinue';
    }
    $encoding = switch( [System.IO.Path]::GetExtension( $path ) ) {
        { $_ -in '.ps1', '.xml' } { [System.Text.Encoding]::UTF8; }
        { $_ -in '.reg', '.vbs', '.js' } { [System.Text.UnicodeEncoding]::new( $false, $true ); }
        default { [System.Text.Encoding]::Default; }
    };
    [System.IO.File]::WriteAllBytes( $path, ( $encoding.GetPreamble() + $encoding.GetBytes( $file.InnerText.Trim() ) ) );
}
  </ExtractScript>

<!-- 5+ Windows Remove Packages (Powershell) -->
  <File path="C:\Windows\Setup\Scripts\remove-packages.ps1">
   <![CDATA[
Get-AppxProvisionedPackage -Online |
Where-Object -Property 'DisplayName' -In -Value @(
'Microsoft.Microsoft3DViewer';
'Microsoft.BingSearch';
'Microsoft.WindowsCalculator';
'Microsoft.WindowsCamera';
'Clipchamp.Clipchamp';
'Microsoft.WindowsAlarms';
'Microsoft.549981C3F5F10';
'Microsoft.Windows.DevHome';
'MicrosoftCorporationII.MicrosoftFamily';
'Microsoft.WindowsFeedbackHub';
'Microsoft.GetHelp';
'microsoft.windowscommunicationsapps';
'Microsoft.WindowsMaps';
'Microsoft.ZuneVideo';
'Microsoft.BingNews';
'Microsoft.MicrosoftOfficeHub';
'Microsoft.Office.OneNote';
'Microsoft.OutlookForWindows';
'Microsoft.Paint';
'Microsoft.MSPaint';
'Microsoft.People';
'Microsoft.Windows.Photos';
'Microsoft.PowerAutomateDesktop';
'MicrosoftCorporationII.QuickAssist';
'Microsoft.SkypeApp';
'Microsoft.MicrosoftSolitaireCollection';
'Microsoft.MicrosoftStickyNotes';
'MSTeams';
'Microsoft.Getstarted';
'Microsoft.Todos';
'Microsoft.WindowsSoundRecorder';
'Microsoft.BingWeather';
'Microsoft.ZuneMusic';
'Microsoft.WindowsTerminal';
'Microsoft.Xbox.TCUI';
'Microsoft.XboxApp';
'Microsoft.XboxGameOverlay';
'Microsoft.XboxGamingOverlay';
'Microsoft.XboxIdentityProvider';
'Microsoft.XboxSpeechToTextOverlay';
'Microsoft.GamingApp';
'Microsoft.YourPhone';
'Microsoft.OneDrive';
'Microsoft.549981C3F5F10';
'Microsoft.MixedReality.Portal';
'Microsoft.Windows.Ai.Copilot.Provider';
'Microsoft.WindowsMeetNow';
) | Remove-AppxProvisionedPackage -AllUsers -Online

Get-WindowsCapability -Online |
Where-Object -FilterScript {
  ($_.Name -split '~')[0] -in @(
'Browser.InternetExplorer';
'MathRecognizer';
'OpenSSH.Client';
'Microsoft.Windows.MSPaint';
'Microsoft.Windows.PowerShell.ISE';
'App.Support.QuickAssist';
'App.StepsRecorder';
'Media.WindowsMediaPlayer';
'Microsoft.Windows.WordPad';
  );
} | Remove-WindowsCapability -Online
   ]]>
  </File>

<!-- 6+ Windows Powershell Tweaks -->
  <File path="C:\Windows\Setup\Scripts\wintweaks.ps1">
   <![CDATA[
# Start Capturing Logs
$logFile = "C:\Windows\Setup\Scripts\wintweaks.log"
Start-Transcript -Path $logFile

# Create Shivaay Folders in Desktop
$desktopPath = "C:\Users\Default\Desktop"
$shell = New-Object -ComObject WScript.Shell
$shivaayPath = New-Item -Path $desktopPath -Name "Shivaay" -ItemType Directory -Force
$optimizationPath = New-Item -Path $shivaayPath -Name "Optimizations" -ItemType Directory -Force
$securityPath = New-Item -Path $shivaayPath -Name "Security" -ItemType Directory -Force
$softwaresPath = New-Item -Path $shivaayPath -Name "Softwares" -ItemType Directory -Force
$managementPath = New-Item -Path $shivaayPath -Name "System Management" -ItemType Directory -Force
$interfacePath = New-Item -Path $shivaayPath -Name "User Interface" -ItemType Directory -Force

# Create WinUtil-CTT and Activate Windows shortcut
function Create-Shortcut {
  param (
    [string]$target,
    [string]$shortcutName,
    [string]$shortcutType,
    [string]$shortcutPath = $shivaayPath
    )
  $shell = New-Object -ComObject WScript.Shell
  $fullPath = Join-Path $shortcutPath $shortcutName
  $softPath = Join-Path $softwaresPath $shortcutName
  if ($shortcutType -eq "url") {
    $internetShortcut = $shell.CreateShortcut($softPath)
    $internetShortcut.TargetPath = $target
    $internetShortcut.Save()
  } else {
    $shortcut = $shell.CreateShortcut($fullPath)
    $shortcut.TargetPath = "powershell.exe"
    $shortcut.Arguments = "-NoProfile -ExecutionPolicy RemoteSigned -Command `"$target`""
    $shortcut.Save()
    }
}
$winUtilCommand = "irm https://christitus.com/win | iex"
Create-Shortcut -target $winUtilCommand -shortcutName 'WinUtil-CTT.lnk'
$activatedCommand = "irm https://get.activated.win | iex"
Create-Shortcut -target $activatedCommand -shortcutName 'Activate-Windows.lnk'

# Softwares
# Game Bar
$gameBar = "ms-windows-store://pdp/?productid=9nzkpstsnw4p"
Create-Shortcut -target $gameBar -shortcutName 'XBOX GameBar.url' -shortcutType "url"

# AMD Radeon Software
$amdRadeon = "ms-windows-store://pdp/?productid=9nz1bjqn6bhl"
Create-Shortcut -target $amdRadeon -shortcutName 'AMD Radeon Software.url' -shortcutType "url"

# Realtek Audio Console
$realtek = "ms-windows-store://pdp/?productid=9p2b8mcsvpln"
Create-Shortcut -target $realtek -shortcutName 'Realtek Audio Console.url' -shortcutType "url"

# Microsoft Tips
$msTips = "ms-windows-store://pdp/?productid=9wzdncrdtbjj"
Create-Shortcut -target $msTips -shortcutName 'Microsoft Tips.url' -shortcutType "url"

# Edge WebView
$edgeWebview = "https://developer.microsoft.com/en-us/microsoft-edge/webview2/"
Create-Shortcut -target $edgeWebview -shortcutName 'Edge WebView2 Runtime.url' -shortcutType "url"

# Memory Reduct
$memReduct = "https://github.com/henrypp/memreduct"
Create-Shortcut -target $memReduct -shortcutName 'Memory Reduct.url' -shortcutType "url"

# Hi-Bit Uninstaller
$hibitUninstaller = "https://hibitsoft.ir/"
Create-Shortcut -target $hibitUninstaller -shortcutName 'Hi-Bit Uninstaller.url' -shortcutType "url"

# Install/Uninstall Microsoft Store
$MSStore = @'
@echo off & reg query "HKU\S-1-5-19" >nul 2>&1
if %errorLevel% neq 0 (
echo Please Run as Administrator.
pause & exit
)
if "%~n0"=="Install Microsoft Store" (
call :INMS
) else (
call :UNMS
)

:INMS
PowerShell -ExecutionPolicy Bypass -Command "Get-AppxPackage -AllUsers Microsoft.WindowsStore | Foreach {Add-AppxPackage -DisableDevelopmentMode -Register \"$($_.InstallLocation)\AppXManifest.xml\"}"
ren "%~dpnx0" "Uninstall Microsoft Store.cmd"
exit /b

:UNMS
PowerShell -ExecutionPolicy Bypass -Command "Get-AppxPackage -Allusers Microsoft.WindowsStore | Remove-AppxPackage"
ren "%~dpnx0" "Install Microsoft Store.cmd"
exit /b
'@
$InstallStore = [System.IO.Path]::Combine($softwaresPath, 'Uninstall Microsoft Store')
$MSStore | Out-File -FilePath "$InstallStore.cmd" -Encoding ASCII

# Security
# Toggle Defender
$Defender = @"
@echo off & reg query "HKU\S-1-5-19" >nul 2>&1
if %errorLevel% neq 0 (
echo Please Run as Administrator.
pause & exit
)
set reg1="HKLM\SYSTEM\CurrentControlSet\Services\Sense"
set reg2="HKLM\SYSTEM\CurrentControlSet\Services\WdBoot"
set reg3="HKLM\SYSTEM\CurrentControlSet\Services\WdFilter"
set reg4="HKLM\SYSTEM\CurrentControlSet\Services\WdNisDrv"
set reg5="HKLM\SYSTEM\CurrentControlSet\Services\WdNisSvc"
set reg6="HKLM\SYSTEM\CurrentControlSet\Services\WinDefend"
set reg7="HKLM\SYSTEM\CurrentControlSet\Services\MDCoreSvc"
set reg8="HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Run"
set reg9="HKCR\*\shellex\ContextMenuHandlers\EPP"
set reg10="HKCR\CLSID\{09A47860-11B0-4DA5-AFA5-26D86198A780}\InprocServer32"
set reg11="HKCR\CLSID\{09A47860-11B0-4DA5-AFA5-26D86198A780}\Version"
set reg12="HKCR\Directory\shellex\ContextMenuHandlers\EPP"
set reg13="HKCR\Drive\shellex\ContextMenuHandlers\EPP"
set reg14="HKCR\CLSID\{09A47860-11B0-4DA5-AFA5-26D86198A780}"
set reg15="HKLM\SOFTWARE\Policies\Microsoft\Windows Defender Security Center\Virus and threat protection"
set reg16="HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer"
set reg17="HKLM\SOFTWARE\Policies\Microsoft\Windows Defender"
set reg18="HKLM\SOFTWARE\Policies\Microsoft\Windows Defender\MpEngine"
set reg19="HKLM\SOFTWARE\Policies\Microsoft\Windows Defender Security Center\App and Browser protection"
bcdedit | findstr /i "safeboot"
if %ERRORLEVEL% EQU 0 (
if "%~n0"=="Enable - Defender" (
reg add %reg1% /v Start /t REG_DWORD /d 2 /f
reg add %reg2% /v Start /t REG_DWORD /d 0 /f
reg add %reg3% /v Start /t REG_DWORD /d 0 /f
reg add %reg4% /v Start /t REG_DWORD /d 2 /f
reg add %reg5% /v Start /t REG_DWORD /d 2 /f
reg add %reg6% /v Start /t REG_DWORD /d 2 /f
reg add %reg7% /v Start /t REG_DWORD /d 2 /f
reg add %reg8% /v "SecurityHealth" /t REG_SZ /d "%windir%\system32\SecurityHealthSystray.exe" /f
reg add %reg9% /ve /d "{09A47860-11B0-4DA5-AFA5-26D86198A780}" /f
reg add %reg10% /ve /d "C:\\Program Files\\Windows Defender\\shellext.dll" /f
reg add %reg10% /v "ThreadingModel" /d "Apartment" /f
reg add %reg11% /ve /d "10.0.18362.1" /f
reg add %reg12% /ve /d "{09A47860-11B0-4DA5-AFA5-26D86198A780}" /f
reg add %reg13% /ve /d "{09A47860-11B0-4DA5-AFA5-26D86198A780}" /f
reg delete %reg15% /v "UILockdown" /f
reg add %reg16% /v "SmartScreenEnabled" /t REG_SZ /d "Warn" /f
reg add %reg17% /v "PUAProtection" /t REG_DWORD /d 1 /f
reg add %reg18% /v "MpEnablePus" /t REG_DWORD /d 1 /f
reg delete %reg19% /v "UILockdown" /f
ren "%~dpnx0" "Disable - Defender.cmd"
) else (
reg add %reg1% /v Start /t REG_DWORD /d 4 /f
reg add %reg2% /v Start /t REG_DWORD /d 4 /f
reg add %reg3% /v Start /t REG_DWORD /d 4 /f
reg add %reg4% /v Start /t REG_DWORD /d 4 /f
reg add %reg5% /v Start /t REG_DWORD /d 4 /f
reg add %reg6% /v Start /t REG_DWORD /d 4 /f
reg add %reg7% /v Start /t REG_DWORD /d 4 /f
reg delete %reg8% /v "SecurityHealth" /f
reg delete %reg9% /f
reg delete %reg14% /f
reg delete %reg12% /f
reg delete %reg13% /f
reg add %reg15% /v UILockdown /t REG_DWORD /d 1 /f
reg add %reg16% /v "SmartScreenEnabled" /t REG_SZ /d "Off" /f
reg add %reg17% /v "PUAProtection" /t REG_DWORD /d 0 /f
reg add %reg18% /v "MpEnablePus" /t REG_DWORD /d 0 /f
reg add %reg19% /v "UILockdown" /t REG_DWORD /d 1 /f
ren "%~dpnx0" "Enable - Defender.cmd"
)
bcdedit /deletevalue {current} safeboot
shutdown /r /t 3
) else (
echo  1. To Toggle On/Off Defender I will boot into safemode.
echo  2. After Booting into safemode run this script again.
pause
bcdedit /set {current} safeboot minimal
shutdown /r /t 3
)
"@
$toggleDefender = [System.IO.Path]::Combine($securityPath, 'Enable - Defender.cmd')
$Defender | Out-File -FilePath $toggleDefender -Encoding ASCII

# Toggle Core Isolation - Memory Integrity 
$memoryIntegrity = @"
@echo off & reg query "HKU\S-1-5-19" >nul 2>&1
if %errorLevel% neq 0 (
echo Please Run as Administrator.
pause & exit
)
set reg1="HKLM\SYSTEM\CurrentControlSet\Control\DeviceGuard\Scenarios\HypervisorEnforcedCodeIntegrity"
set reg2="HKLM\SOFTWARE\Policies\Microsoft\Windows Defender Security Center\Device security"
if "%~n0"=="Enable - Core Isolation" (
reg add %reg1% /v Enabled /t REG_DWORD /d 1 /f
reg delete %reg2% /v "UILockdown" /f
ren "%~dpnx0" "Disable - Core Isolation.cmd"
) else (
reg add %reg1% /v Enabled /t REG_DWORD /d 0 /f
reg add %reg2% /v "UILockdown" /t REG_DWORD /d 1 /f
ren "%~dpnx0" "Enable - Core Isolation.cmd"
)
"@
$toggleMemoryIntegrity = [System.IO.Path]::Combine($securityPath, 'Enable - Core Isolation.cmd')
$memoryIntegrity | Out-File -FilePath $toggleMemoryIntegrity -Encoding ASCII

# Show/Hide Unused Security Pages
$UnusedSecurityPages = @"
@echo off & reg query "HKU\S-1-5-19" >nul 2>&1
if %errorLevel% neq 0 (
echo Please Run as Administrator.
pause & exit
)
set reg1="HKLM\SOFTWARE\Policies\Microsoft\Windows Defender Security Center\Device performance and health"
set reg2="HKLM\SOFTWARE\Policies\Microsoft\Windows Defender Security Center\Family options"
set reg3="HKLM\SOFTWARE\Policies\Microsoft\Windows Defender Security Center\Account protection"
if "%~n0"=="Hide - Unused Security Pages" (
reg add %reg1% /v "UILockdown" /t REG_DWORD /d 1 /f
reg add %reg2% /v "UILockdown" /t REG_DWORD /d 1 /f
reg add %reg3% /v "UILockdown" /t REG_DWORD /d 1 /f
ren "%~dpnx0" "Show - Unused Security Pages.cmd"
) else (
reg delete %reg1% /v "UILockdown" /f
reg delete %reg2% /v "UILockdown" /f
reg delete %reg3% /v "UILockdown" /f
ren "%~dpnx0" "Hide - Unused Security Pages.cmd"
)
"@
$toggleUnusedSecurityPages = [System.IO.Path]::Combine($securityPath, 'Show - Unused Security Pages.cmd')
$UnusedSecurityPages | Out-File -FilePath $toggleUnusedSecurityPages -Encoding ASCII

# System Management
# Toggle Hibernation and Fast Startup
$hibernationToggle = @"
@echo off & reg query "HKU\S-1-5-19" >nul 2>&1
if %errorLevel% neq 0 (
echo Please Run as Administrator.
pause & exit
)
if "%~n0"=="Enable - Hibernation and Fast Startup" (
powercfg /hibernate on
reg add "HKLM\SYSTEM\CurrentControlSet\Control\Session Manager\Power" /v HiberbootEnabled /t REG_DWORD /d 1 /f
ren "%~dpnx0" "Disable - Hibernation and Fast Startup.cmd"
) else (
powercfg /hibernate off
ren "%~dpnx0" "Enable - Hibernation and Fast Startup.cmd"
)
"@
$toggleHibernation = [System.IO.Path]::Combine($managementPath, 'Enable - Hibernation and Fast Startup')
$hibernationToggle | Out-File -FilePath "$toggleHibernation.cmd" -Encoding ASCII

# Toggle GameDVR
$gameDVR = @"
@echo off & reg query "HKU\S-1-5-19" >nul 2>&1
if %errorLevel% neq 0 (
echo Please Run as Administrator.
pause & exit
)
set reg1="HKCU\System\GameConfigStore"
set reg2="HKLM\SOFTWARE\Policies\Microsoft\Windows\GameDVR"
if "%~n0"=="Enable - GameDVR" (
reg add %reg1% /v GameDVR_FSEBehavior /t REG_DWORD /d 0 /f
reg add %reg1% /v GameDVR_Enabled /t REG_DWORD /d 1 /f
reg add %reg1% /v GameDVR_DXGIHonorFSEWindowsCompatible /t REG_DWORD /d 0 /f
reg add %reg1% /v GameDVR_HonorUserFSEBehaviorMode /t REG_DWORD /d 0 /f
reg add %reg1% /v GameDVR_EFSEFeatureFlags /t REG_DWORD /d 1 /f
reg add %reg2% /v AllowGameDVR /t REG_DWORD /d 1 /f
    ren "%~dpnx0" "Disable - GameDVR.cmd"
) else (
reg delete %reg1% /v GameDVR_FSEBehavior /f
reg delete %reg1% /v GameDVR_Enabled /f
reg delete %reg1% /v GameDVR_DXGIHonorFSEWindowsCompatible /f
reg delete %reg1% /v GameDVR_HonorUserFSEBehaviorMode /f
reg delete %reg1% /v GameDVR_EFSEFeatureFlags /f
reg delete %reg2% /v AllowGameDVR /f
ren "%~dpnx0" "Enable - GameDVR.cmd"
)
"@
$toggleGameDVR = [System.IO.Path]::Combine($managementPath, 'Enable - GameDVR')
$gameDVR | Out-File -FilePath "$toggleGameDVR.cmd" -Encoding ASCII

# Toggle Windows Search Indexing Service
$searchService = @"
@echo off & reg query "HKU\S-1-5-19" >nul 2>&1
if %errorLevel% neq 0 (
echo Please Run as Administrator.
pause & exit
)
if "%~n0"=="Enable - Search Indexing" (
sc config WSearch start=auto
net start WSearch
set st="Disable - Search Indexing.cmd"
) else (
net stop WSearch
sc config WSearch start=disabled
set st="Enable - Search Indexing.cmd"
)
ren "%~dpnx0" %st% & taskkill /f /im explorer.exe & start explorer.exe
"@
$toggleSearchService = [System.IO.Path]::Combine($managementPath, 'Enable - Search Indexing')
$searchService | Out-File -FilePath "$toggleSearchService.cmd" -Encoding ASCII

# Toggle Notifications and Background Apps
$notificationToggle = @"
@echo off & reg query "HKU\S-1-5-19" >nul 2>&1
if %errorLevel% neq 0 (
echo Please Run as Administrator.
pause & exit
)
set reg1="HKCU\Software\Policies\Microsoft\Windows\Explorer"
set reg2="HKCU\Software\Microsoft\Windows\CurrentVersion\PushNotifications"
set reg3="HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\BackgroundAccessApplications"
if "%~n0"=="Enable - Notifications and Background Apps" (
reg add %reg1% /v DisableNotificationCenter /t REG_DWORD /d 0 /f
reg add %reg2% /v ToastEnabled /t REG_DWORD /d 1 /f
reg add %reg3% /v GlobalUserDisabled /t REG_DWORD /d 0 /f
set st="Disable - Notifications and Background Apps.cmd"
) else (
reg add %reg1% /v DisableNotificationCenter /t REG_DWORD /d 1 /f
reg add %reg2% /v ToastEnabled /t REG_DWORD /d 0 /f
reg add %reg3% /v GlobalUserDisabled /t REG_DWORD /d 1 /f
set st="Enable - Notifications and Background Apps.cmd"
)
ren "%~dpnx0" %st% & taskkill /f /im explorer.exe & start explorer.exe
"@
$toggleNotification = [System.IO.Path]::Combine($managementPath, 'Enable - Notifications and Background Apps')
$notificationToggle | Out-File -FilePath "$toggleNotification.cmd" -Encoding ASCII

# Toggle Windows Printer Spooler Service
$spoolerService = @"
@echo off & reg query "HKU\S-1-5-19" >nul 2>&1
if %errorLevel% neq 0 (
echo Please Run as Administrator.
pause & exit
)
if "%~n0"=="Enable - Printer Spooler" (
sc config Spooler start=auto
net start Spooler
ren "%~dpnx0" "Disable - Printer Spooler.cmd"
) else (
net stop Spooler
sc config Spooler start=disabled
ren "%~dpnx0" "Enable - Printer Spooler.cmd"
)
"@
$toggleSpoolerService = [System.IO.Path]::Combine($managementPath, 'Enable - Printer Spooler')
$spoolerService | Out-File -FilePath "$toggleSpoolerService.cmd" -Encoding ASCII

# Optimizations
# Toggle Update Notifications
$updateNotifications = @"
@echo off & reg query "HKU\S-1-5-19" >nul 2>&1
if %errorLevel% neq 0 (
echo Please Run as Administrator.
pause & exit
)
set reg1="HKLM\SOFTWARE\Policies\Microsoft\Windows\WindowsUpdate"
set reg2="HKLM\SOFTWARE\Microsoft\WindowsUpdate\UX\Settings"
if "%~n0"=="Enable - Update Notifications" (
reg add %reg1% /v SetAutoRestartNotificationDisable /t REG_DWORD /d 0 /f
reg add %reg2% /v RestartNotificationsAllowed2 /t REG_DWORD /d 1 /f
reg add %reg1% /v SetUpdateNotificationLevel /t REG_DWORD /d 1 /f
ren "%~dpnx0" "Disable - Update Notifications.cmd"
) else (
reg delete %reg1% /v SetAutoRestartNotificationDisable /f
reg delete %reg2% /v RestartNotificationsAllowed2 /f
reg delete %reg1% /v SetUpdateNotificationLevel /f
ren "%~dpnx0" "Enable - Update Notifications.cmd"
)
"@
$toggleUpdateNotifications = [System.IO.Path]::Combine($optimizationPath, 'Disable - Update Notifications.cmd')
$updateNotifications | Out-File -FilePath $toggleUpdateNotifications -Encoding ASCII

# Toggle Automatic Folder Discovery
$automaticFolder = @"
@echo off & reg query "HKU\S-1-5-19" >nul 2>&1
if %errorLevel% neq 0 (
echo Please Run as Administrator.
pause & exit
)
set reg1="HKCU\Software\Classes\Local Settings\Software\Microsoft\Windows\Shell\Bags\AllFolders\Shell"
if "%~n0"=="Enable Automatic Folder Discovery" (
reg delete %reg1% /f
ren "%~dpnx0" "Disable - Automatic Folder Discovery.cmd"
) else (
reg add %reg1% /v "FolderType" /t REG_SZ /d "NotSpecified" /f
ren "%~dpnx0" "Enable - Automatic Folder Discovery.cmd"
)
"@
$toggleAutomaticFolder = [System.IO.Path]::Combine($optimizationPath, 'Enable - Automatic Folder Discovery.cmd')
$automaticFolder | Out-File -FilePath $toggleAutomaticFolder -Encoding ASCII

# Toggle Last Access Time Stamp and 8.3 Char Length File Name Creation
$toggleFileSystemSettings = @"
@echo off & reg query "HKU\S-1-5-19" >nul 2>&1
if %errorLevel% neq 0 (
echo Please Run as Administrator.
pause & exit
)
if "%~n0"=="Disable - Last Access Time and 8.3 Name" (
fsutil behavior set disableLastAccess 1
fsutil behavior set disable8dot3 1
ren "%~dpnx0" "Enable - Last Access Time and 8.3 Name.cmd"
) else (
fsutil behavior set disableLastAccess 0
fsutil behavior set disable8dot3 0
ren "%~dpnx0" "Disable - Last Access Time and 8.3 Name.cmd"
)
"@
$toggleFileSystemSettingsPath = [System.IO.Path]::Combine($optimizationPath, 'Enable - Last Access Time and 8.3 Name.cmd')
$toggleFileSystemSettings | Out-File -FilePath $toggleFileSystemSettingsPath -Encoding ASCII

# Toggle Multi-Plane Overlay
$toggleOverlayTestMode = @"
@echo off & reg query "HKU\S-1-5-19" >nul 2>&1
if %errorLevel% neq 0 (
echo Please Run as Administrator.
pause & exit
)
set reg1="HKLM\SOFTWARE\Microsoft\Windows\Dwm"
if "%~n0"=="Enable - Multi-Plane Overlay" (
reg delete %reg1% /v OverlayTestMode /f
ren "%~dpnx0" "Disable - Multi-Plane Overlay.cmd"
) else (
reg add %reg1% /v OverlayTestMode /t REG_DWORD /d 5 /f
ren "%~dpnx0" "Enable - Multi-Plane Overlay.cmd"
)
"@
$toggleOverlayTestModePath = [System.IO.Path]::Combine($optimizationPath, 'Enable - Multi-Plane Overlay.cmd')
$toggleOverlayTestMode | Out-File -FilePath $toggleOverlayTestModePath -Encoding ASCII

# User Interface
# Toggle Gallery in File Explorer
$toggleGalleryExplorer = @"
@echo off & reg query "HKU\S-1-5-19" >nul 2>&1
if %errorLevel% neq 0 (
echo Please Run as Administrator.
pause & exit
)
set reg1="HKCU\Software\Classes\CLSID\{e88865ea-0e1c-4e20-9aa6-edcd0212c87c}"
if "%~n0"=="Show - Gallery In File Explorer" (
reg add %reg1% /v System.IsPinnedToNameSpaceTree /t REG_DWORD /d 1 /f
set st="Hide - Gallery In File Explorer.cmd"
) else (
reg delete %reg1% /v System.IsPinnedToNameSpaceTree /f
set st="Show - Gallery In File Explorer.cmd"
)
ren "%~dpnx0" %st% & taskkill /f /im explorer.exe & start explorer.exe
"@
$toggleGalleryExplorerPath = [System.IO.Path]::Combine($interfacePath, 'Show - Gallery In File Explorer.cmd')
$toggleGalleryExplorer | Out-File -FilePath $toggleGalleryExplorerPath -Encoding ASCII

# Toggle Network Navigation Pane in File Explorer
$toggleNetworkNavigation = @"
@echo off & reg query "HKU\S-1-5-19" >nul 2>&1
if %errorLevel% neq 0 (
echo Please Run as Administrator.
pause & exit
)
set reg1="HKCU\SOFTWARE\Classes\CLSID\{F02C1A0D-BE21-4350-88B0-7367FC96EF3C}"
if "%~n0%"=="Show - Network Navigation In File Explorer" (
reg add %reg1% /v System.IsPinnedToNameSpaceTree /t REG_SZ /d "1" /f
set st="Hide - Network Navigation In File Explorer.cmd"
) else (
reg delete %reg1% /v System.IsPinnedToNameSpaceTree /f
set st="Show - Network Navigation In File Explorer.cmd"
)
ren "%~dpnx0" %st% & taskkill /f /im explorer.exe & start explorer.exe
"@
$toggleNetworkNavigationPath = [System.IO.Path]::Combine($interfacePath, 'Show - Network Navigation In File Explorer.cmd')
$toggleNetworkNavigation | Out-File -FilePath $toggleNetworkNavigationPath -Encoding ASCII

# Toggle Recycle Bin in File Explorer
$toggleRecycleBin = @"
@echo off
reg query "HKU\S-1-5-19" >nul 2>&1
if %errorLevel% neq 0 (
echo Please Run as Administrator.
pause & exit
)
set reg1="HKCU\Software\Classes\CLSID\{645FF040-5081-101B-9F08-00AA002F954E}"
if "%~n0%"=="Pin - Recycle Bin In File Explorer" (
reg add %reg1% /v System.IsPinnedToNameSpaceTree /t REG_DWORD /d 1 /f
set st="Unpin - Recycle Bin In File Explorer.cmd"
) else (
reg add %reg1% /v System.IsPinnedToNameSpaceTree /t REG_DWORD /d 0 /f
set st="Pin - Recycle Bin In File Explorer.cmd"
)
ren "%~dpnx0" %st% & taskkill /f /im explorer.exe & start explorer.exe
"@
$toggleRecycleBinPath = [System.IO.Path]::Combine($interfacePath, 'Unpin - Recycle Bin In File Explorer.cmd')
$toggleRecycleBin | Out-File -FilePath $toggleRecycleBinPath -Encoding ASCII

# Toggle Removable Drives in File Explorer
$toggleRemovableDrives = @"
@echo off & reg query "HKU\S-1-5-19" >nul 2>&1
if %errorLevel% neq 0 (
echo Please Run as Administrator.
pause & exit
)
set reg1="HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\Desktop\NameSpace\DelegateFolders\{F5FB2C77-0E2F-4A16-A381-3E560C68BC83}"
set reg2="HKLM\SOFTWARE\WOW6432Node\Microsoft\Windows\CurrentVersion\Explorer\Desktop\NameSpace\DelegateFolders\{F5FB2C77-0E2F-4A16-A381-3E560C68BC83}\{F5FB2C77-0E2F-4A16-A381-3E560C68BC83}"
if "%~n0%"=="Show - Removable Drives In File Explorer Quick Access" (
reg add %reg1% /ve /d "Removable Drives" /f
reg add %reg2% /ve /d "Removable Drives" /f
set st="Hide - Removable Drives In File Explorer Quick Access.cmd"
) else (
reg delete %reg1% /f
reg delete %reg2% /f
set st="Show - Removable Drives In File Explorer Quick Access.cmd"
)
ren "%~dpnx0" %st% & taskkill /f /im explorer.exe & start explorer.exe
"@
$toggleRemovableDrivesPath = [System.IO.Path]::Combine($interfacePath, 'Show - Removable Drives In File Explorer Quick Access.cmd')
$toggleRemovableDrives | Out-File -FilePath $toggleRemovableDrivesPath -Encoding ASCII

# Toggle Context Menu
$contextMenu = @"
@echo off & reg query "HKU\S-1-5-19" >nul 2>&1
if %errorLevel% neq 0 (
echo Please Run as Administrator.
pause & exit
)
if "%~n0"=="Enable - NEW Context Menu" (
reg delete "HKCU\Software\Classes\CLSID\{86ca1aa0-34aa-4e8b-a509-50c905bae2a2}" /f
set st="Enable - OLD Context Menu.cmd"
) else (
reg add "HKCU\Software\Classes\CLSID\{86ca1aa0-34aa-4e8b-a509-50c905bae2a2}\InprocServer32" /f
set st="Enable - NEW Context Menu.cmd"
)
ren "%~dpnx0" %st% & taskkill /f /im explorer.exe & start explorer.exe
"@
$toggleContextMenuPath = [System.IO.Path]::Combine($interfacePath, 'Enable - NEW Context Menu.cmd')
$contextMenu | Out-File -FilePath $toggleContextMenuPath -Encoding ASCII

# Toggle Recent Items in Windows
$toggleRecentItems = @"
@echo off & reg query "HKU\S-1-5-19" >nul 2>&1
if %errorLevel% neq 0 (
echo Please Run as Administrator.
pause & exit
)
set reg1="HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\Explorer"
set reg2="HKLM\SOFTWARE\Policies\Microsoft\Windows\Explorer"
set reg3="HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\Explorer"
set reg4="HKCU\SOFTWARE\Policies\Microsoft\Windows\Explorer"
set reg5="HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\Advanced"
if "%~n0%"=="Disable - Recent Items" (
reg add %reg1% /v "NoStartMenuMFUprogramsList" /t REG_DWORD /d "1" /f
reg add %reg1% /v "NoRecentDocsHistory" /t REG_DWORD /d "1" /f
reg add %reg2% /v "ShowOrHideMostUsedApps" /t REG_DWORD /d "1" /f
reg add %reg2% /v "HideRecentlyAddedApps" /t REG_DWORD /d "1" /f
reg add %reg3% /v "NoInstrumentation" /t REG_DWORD /d "1" /f
reg add %reg3% /v "ClearRecentDocsOnExit" /t REG_DWORD /d "1" /f
reg add %reg3% /v "NoRecentDocsHistory" /t REG_DWORD /d "1" /f
reg add %reg4% /v "NoRemoteDestinations" /t REG_DWORD /d "1" /f
reg add %reg5% /v "Start_TrackProgs" /t REG_DWORD /d "0" /f
reg add %reg5% /v "Start_TrackDocs" /t REG_DWORD /d "0" /f
set st="Enable - Recent Items.cmd"
) else (
reg delete %reg1% /v "NoStartMenuMFUprogramsList" /f
reg delete %reg1% /v "NoRecentDocsHistory" /f
reg delete %reg2% /v "ShowOrHideMostUsedApps" /f
reg delete %reg2% /v "HideRecentlyAddedApps" /f
reg delete %reg3% /v "NoInstrumentation" /f
reg delete %reg3% /v "ClearRecentDocsOnExit" /f
reg delete %reg3% /v "NoRecentDocsHistory" /f
reg delete %reg4% /v "NoRemoteDestinations" /f
reg add %reg5% /v "Start_TrackProgs" /t REG_DWORD /d "1" /f
reg add %reg5% /v "Start_TrackDocs" /t REG_DWORD /d "1" /f
set st="Disable - Recent Items.cmd"
)
ren "%~dpnx0" %st% & taskkill /f /im explorer.exe & start explorer.exe
"@
$toggleRecentItemsPath = [System.IO.Path]::Combine($interfacePath, 'Enable - Recent Items.cmd')
$toggleRecentItems | Out-File -FilePath $toggleRecentItemsPath -Encoding ASCII

# Configure Maximum Password Age in Windows
net.exe accounts /maxpwage:UNLIMITED

# Groups or splits svchost.exe processes based on the amount of physical memory in the system to optimize performance
$ram = (Get-CimInstance -ClassName Win32_PhysicalMemory | Measure-Object -Property Capacity -Sum).Sum / 1kb
Set-ItemProperty -Path "HKLM:\SYSTEM\CurrentControlSet\Control" -Name "SvcHostSplitThresholdInKB" -Type DWord -Value $ram -Force

$autoLoggerDir = "$env:PROGRAMDATA\Microsoft\Diagnosis\ETLLogs\AutoLogger"
If (Test-Path "$autoLoggerDir\AutoLogger-Diagtrack-Listener.etl") {
Remove-Item "$autoLoggerDir\AutoLogger-Diagtrack-Listener.etl"
}
$icaclsCommand = "icacls `"$autoLoggerDir`" /deny SYSTEM:`"(OI)(CI)F`""
Invoke-Expression $icaclsCommand | Out-Null

# Disable Defender Auto Sample Submission
Set-MpPreference -SubmitSamplesConsent 2 -ErrorAction Continue | Out-Null

# Remove Edge
Stop-Service -Name edgeupdate -Force
Stop-Service -Name edgeupdatem -Force
Get-Process *edge* | Stop-Process -Force -ErrorAction SilentlyContinue
Remove-Item -Path "C:\Program Files (x86)\Microsoft\Edge" -Recurse -Force -ErrorAction Continue
Remove-Item -Path "C:\Program Files (x86)\Microsoft\EdgeWebView" -Recurse -Force -ErrorAction Continue
Remove-Item -Path "C:\Program Files (x86)\Microsoft\EdgeUpdate" -Recurse -Force -ErrorAction Continue
Remove-Item -Path "C:\Program Files (x86)\Microsoft\EdgeCore" -Recurse -Force -ErrorAction Continue
Remove-Item -Path "C:\Users\Public\Desktop\Microsoft Edge.lnk" -Recurse -Force -ErrorAction Continue
Remove-Item -Path "C:\ProgramData\Microsoft\Windows\Start Menu\Programs\Microsoft Edge.lnk" -Recurse -Force -ErrorAction Continue
Remove-Item -Path "C:\Windows\SystemApps\Microsoft.MicrosoftEdge_8wekyb3d8bbwe" -Recurse -Force -ErrorAction Continue
Remove-Item -Path "C:\Windows\SystemApps\Microsoft.MicrosoftEdgeDevToolsClient_8wekyb3d8bbwe" -Recurse -Force -ErrorAction Continue

# Removes OneDrive
Remove-Item "C:\Users\Default\AppData\Roaming\Microsoft\Windows\Start Menu\Programs\OneDrive.lnk" -ErrorAction Continue
Remove-Item "C:\Users\Default\AppData\Roaming\Microsoft\Windows\Start Menu\Programs\OneDrive.exe" -ErrorAction Continue
Remove-Item "C:\Windows\System32\OneDriveSetup.exe" -ErrorAction Continue
Remove-Item "C:\Windows\SysWOW64\OneDriveSetup.exe" -ErrorAction Continue

# Removes Microsoft Teams
$TeamsPath = [System.IO.Path]::Combine($env:LOCALAPPDATA, 'Microsoft', 'Teams')
$TeamsUpdateExePath = [System.IO.Path]::Combine($TeamsPath, 'Update.exe')
Stop-Process -Name "*teams*" -Force -ErrorAction Continue
if ([System.IO.File]::Exists($TeamsUpdateExePath)) {
# Uninstall app
$proc = Start-Process $TeamsUpdateExePath "-uninstall -s" -PassThru
$proc.WaitForExit()
}
Get-AppxPackage "*Teams*" | Remove-AppxPackage -ErrorAction Continue
Get-AppxPackage "*Teams*" -AllUsers | Remove-AppxPackage -AllUsers -ErrorAction Continue
if ([System.IO.Directory]::Exists($TeamsPath)) {
Remove-Item $TeamsPath -Force -Recurse -ErrorAction Continue
}

# Uninstall from Uninstall registry key UninstallString
$us = (Get-ChildItem -Path HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall, HKLM:\SOFTWARE\Wow6432Node\Microsoft\Windows\CurrentVersion\Uninstall | Get-ItemProperty | Where-Object { $_.DisplayName -like '*Teams*'}).UninstallString
if ($us.Length -gt 0) {
$us = ($us.Replace('/I', '/uninstall ') + ' /quiet').Replace('  ', ' ')
$FilePath = ($us.Substring(0, $us.IndexOf('.exe') + 4).Trim())
$ProcessArgs = ($us.Substring($us.IndexOf('.exe') + 5).Trim().replace('  ', ' '))
$proc = Start-Process -FilePath $FilePath -Args $ProcessArgs -PassThru
$proc.WaitForExit()
}

# Disable Teredo
$registryKeysTeredo = @(
@{Path = "HKLM:\SYSTEM\CurrentControlSet\Services\Tcpip6\Parameters"; Name = "DisabledComponents"; Type = "DWord"; Value = 1}
)
foreach ($key in $registryKeysTeredo) {
New-ItemProperty -Path $key.Path -Name $key.Name -PropertyType $key.Type -Value $key.Value -Force
}
netsh interface teredo set state disabled

# Disable Scheduled Tasks
$scheduledTasks = @(
"Microsoft\Windows\Application Experience\Microsoft Compatibility Appraiser",
"Microsoft\Windows\Application Experience\ProgramDataUpdater",
"Microsoft\Windows\Autochk\Proxy",
"Microsoft\Windows\Customer Experience Improvement Program\Consolidator",
"Microsoft\Windows\Customer Experience Improvement Program\UsbCeip",
"Microsoft\Windows\DiskDiagnostic\Microsoft-Windows-DiskDiagnosticDataCollector",
"Microsoft\Windows\Feedback\Siuf\DmClient",
"Microsoft\Windows\Feedback\Siuf\DmClientOnScenarioDownload",
"Microsoft\Windows\Windows Error Reporting\QueueReporting",
"Microsoft\Windows\Application Experience\MareBackup",
"Microsoft\Windows\Application Experience\StartupAppTask",
"Microsoft\Windows\Application Experience\PcaPatchDbTask",
"Microsoft\Windows\Maps\MapsUpdateTask",
"Microsoft\EdgeUpdate\EdgeUpdateTaskMachineCore",
"Microsoft\EdgeUpdate\EdgeUpdateTaskMachineUA"
)
foreach ($task in $scheduledTasks) {
schtasks /Change /TN $task /Disable
}

# Disable Reserved Storage (To free up some space)
DISM /Online /Set-ReservedStorageState /State:Disabled

# Set Services to Manual
Set-Service -Name 'AJRouter' -StartupType Disabled -ErrorAction Continue
Set-Service -Name 'ALG' -StartupType Manual -ErrorAction Continue
Set-Service -Name 'AppIDSvc' -StartupType Manual -ErrorAction Continue
Set-Service -Name 'AppMgmt' -StartupType Manual -ErrorAction Continue
Set-Service -Name 'AppReadiness' -StartupType Manual -ErrorAction Continue
Set-Service -Name 'AppVClient' -StartupType Disabled -ErrorAction Continue
Set-Service -Name 'AppXSvc' -StartupType Manual -ErrorAction Continue
Set-Service -Name 'Appinfo' -StartupType Manual -ErrorAction Continue
Set-Service -Name 'AssignedAccessManagerSvc' -StartupType Disabled -ErrorAction Continue
Set-Service -Name 'AudioEndpointBuilder' -StartupType Automatic -ErrorAction Continue
Set-Service -Name 'AudioSrv' -StartupType Automatic -ErrorAction Continue
Set-Service -Name 'Audiosrv' -StartupType Automatic -ErrorAction Continue
Set-Service -Name 'AxInstSV' -StartupType Manual -ErrorAction Continue
Set-Service -Name 'BDESVC' -StartupType Manual -ErrorAction Continue
Set-Service -Name 'BFE' -StartupType Automatic -ErrorAction Continue
Set-Service -Name 'BITS' -StartupType Manual -ErrorAction Continue
Set-Service -Name 'BTAGService' -StartupType Manual -ErrorAction Continue
Set-Service -Name 'BcastDVRUserService_*' -StartupType Manual -ErrorAction Continue
Set-Service -Name 'BrokerInfrastructure' -StartupType Automatic -ErrorAction Continue
Set-Service -Name 'Browser' -StartupType Manual -ErrorAction Continue
Set-Service -Name 'BthAvctpSvc' -StartupType Automatic -ErrorAction Continue
Set-Service -Name 'BthHFSrv' -StartupType Automatic -ErrorAction Continue
Set-Service -Name 'CDPSvc' -StartupType Manual -ErrorAction Continue
Set-Service -Name 'CDPUserSvc_*' -StartupType Automatic -ErrorAction Continue
Set-Service -Name 'COMSysApp' -StartupType Manual -ErrorAction Continue
Set-Service -Name 'CaptureService_*' -StartupType Manual -ErrorAction Continue
Set-Service -Name 'CertPropSvc' -StartupType Manual -ErrorAction Continue
Set-Service -Name 'ClipSVC' -StartupType Manual -ErrorAction Continue
Set-Service -Name 'ConsentUxUserSvc_*' -StartupType Manual -ErrorAction Continue
Set-Service -Name 'CoreMessagingRegistrar' -StartupType Automatic -ErrorAction Continue
Set-Service -Name 'CredentialEnrollmentManagerUserSvc_*' -StartupType Manual -ErrorAction Continue
Set-Service -Name 'CryptSvc' -StartupType Automatic -ErrorAction Continue
Set-Service -Name 'CscService' -StartupType Manual -ErrorAction Continue
Set-Service -Name 'DPS' -StartupType Automatic -ErrorAction Continue
Set-Service -Name 'DcomLaunch' -StartupType Automatic -ErrorAction Continue
Set-Service -Name 'DcpSvc' -StartupType Manual -ErrorAction Continue
Set-Service -Name 'DevQueryBroker' -StartupType Manual -ErrorAction Continue
Set-Service -Name 'DeviceAssociationBrokerSvc_*' -StartupType Manual -ErrorAction Continue
Set-Service -Name 'DeviceAssociationService' -StartupType Manual -ErrorAction Continue
Set-Service -Name 'DeviceInstall' -StartupType Manual -ErrorAction Continue
Set-Service -Name 'DevicePickerUserSvc_*' -StartupType Manual -ErrorAction Continue
Set-Service -Name 'DevicesFlowUserSvc_*' -StartupType Manual -ErrorAction Continue
Set-Service -Name 'Dhcp' -StartupType Automatic -ErrorAction Continue
Set-Service -Name 'DiagTrack' -StartupType Disabled -ErrorAction Continue
Set-Service -Name 'DialogBlockingService' -StartupType Disabled -ErrorAction Continue
Set-Service -Name 'DispBrokerDesktopSvc' -StartupType Automatic -ErrorAction Continue
Set-Service -Name 'DisplayEnhancementService' -StartupType Manual -ErrorAction Continue
Set-Service -Name 'DmEnrollmentSvc' -StartupType Manual -ErrorAction Continue
Set-Service -Name 'Dnscache' -StartupType Automatic -ErrorAction Continue
Set-Service -Name 'DoSvc' -StartupType Manual -ErrorAction Continue
Set-Service -Name 'DsSvc' -StartupType Manual -ErrorAction Continue
Set-Service -Name 'DsmSvc' -StartupType Manual -ErrorAction Continue
Set-Service -Name 'DusmSvc' -StartupType Automatic -ErrorAction Continue
Set-Service -Name 'EFS' -StartupType Manual -ErrorAction Continue
Set-Service -Name 'EapHost' -StartupType Manual -ErrorAction Continue
Set-Service -Name 'EntAppSvc' -StartupType Manual -ErrorAction Continue
Set-Service -Name 'EventLog' -StartupType Automatic -ErrorAction Continue
Set-Service -Name 'EventSystem' -StartupType Automatic -ErrorAction Continue
Set-Service -Name 'FDResPub' -StartupType Manual -ErrorAction Continue
Set-Service -Name 'Fax' -StartupType Manual -ErrorAction Continue
Set-Service -Name 'FontCache' -StartupType Automatic -ErrorAction Continue
Set-Service -Name 'FrameServer' -StartupType Manual -ErrorAction Continue
Set-Service -Name 'FrameServerMonitor' -StartupType Manual -ErrorAction Continue
Set-Service -Name 'GraphicsPerfSvc' -StartupType Manual -ErrorAction Continue
Set-Service -Name 'HomeGroupListener' -StartupType Manual -ErrorAction Continue
Set-Service -Name 'HomeGroupProvider' -StartupType Manual -ErrorAction Continue
Set-Service -Name 'HvHost' -StartupType Manual -ErrorAction Continue
Set-Service -Name 'IEEtwCollectorService' -StartupType Manual -ErrorAction Continue
Set-Service -Name 'IKEEXT' -StartupType Manual -ErrorAction Continue
Set-Service -Name 'InstallService' -StartupType Manual -ErrorAction Continue
Set-Service -Name 'InventorySvc' -StartupType Manual -ErrorAction Continue
Set-Service -Name 'IpxlatCfgSvc' -StartupType Manual -ErrorAction Continue
Set-Service -Name 'KeyIso' -StartupType Automatic -ErrorAction Continue
Set-Service -Name 'KtmRm' -StartupType Manual -ErrorAction Continue
Set-Service -Name 'LSM' -StartupType Automatic -ErrorAction Continue
Set-Service -Name 'LanmanServer' -StartupType Automatic -ErrorAction Continue
Set-Service -Name 'LanmanWorkstation' -StartupType Automatic -ErrorAction Continue
Set-Service -Name 'LicenseManager' -StartupType Manual -ErrorAction Continue
Set-Service -Name 'LxpSvc' -StartupType Manual -ErrorAction Continue
Set-Service -Name 'MSDTC' -StartupType Manual -ErrorAction Continue
Set-Service -Name 'MSiSCSI' -StartupType Manual -ErrorAction Continue
Set-Service -Name 'MapsBroker' -StartupType Manual -ErrorAction Continue
Set-Service -Name 'McpManagementService' -StartupType Manual -ErrorAction Continue
Set-Service -Name 'MessagingService_*' -StartupType Manual -ErrorAction Continue
Set-Service -Name 'MicrosoftEdgeElevationService' -StartupType Manual -ErrorAction Continue
Set-Service -Name 'MixedRealityOpenXRSvc' -StartupType Manual -ErrorAction Continue
Set-Service -Name 'MpsSvc' -StartupType Automatic -ErrorAction Continue
Set-Service -Name 'MsKeyboardFilter' -StartupType Manual -ErrorAction Continue
Set-Service -Name 'NPSMSvc_*' -StartupType Manual -ErrorAction Continue
Set-Service -Name 'NaturalAuthentication' -StartupType Manual -ErrorAction Continue
Set-Service -Name 'NcaSvc' -StartupType Manual -ErrorAction Continue
Set-Service -Name 'NcbService' -StartupType Manual -ErrorAction Continue
Set-Service -Name 'NcdAutoSetup' -StartupType Manual -ErrorAction Continue
Set-Service -Name 'NetSetupSvc' -StartupType Manual -ErrorAction Continue
Set-Service -Name 'NetTcpPortSharing' -StartupType Disabled -ErrorAction Continue
Set-Service -Name 'Netlogon' -StartupType Automatic -ErrorAction Continue
Set-Service -Name 'Netman' -StartupType Manual -ErrorAction Continue
Set-Service -Name 'NgcCtnrSvc' -StartupType Manual -ErrorAction Continue
Set-Service -Name 'NgcSvc' -StartupType Manual -ErrorAction Continue
Set-Service -Name 'NlaSvc' -StartupType Manual -ErrorAction Continue
Set-Service -Name 'OneSyncSvc_*' -StartupType Automatic -ErrorAction Continue
Set-Service -Name 'P9RdrService_*' -StartupType Manual -ErrorAction Continue
Set-Service -Name 'PNRPAutoReg' -StartupType Manual -ErrorAction Continue
Set-Service -Name 'PNRPsvc' -StartupType Manual -ErrorAction Continue
Set-Service -Name 'PcaSvc' -StartupType Manual -ErrorAction Continue
Set-Service -Name 'PeerDistSvc' -StartupType Manual -ErrorAction Continue
Set-Service -Name 'PenService_*' -StartupType Manual -ErrorAction Continue
Set-Service -Name 'PerfHost' -StartupType Manual -ErrorAction Continue
Set-Service -Name 'PhoneSvc' -StartupType Manual -ErrorAction Continue
Set-Service -Name 'PimIndexMaintenanceSvc_*' -StartupType Manual -ErrorAction Continue
Set-Service -Name 'PlugPlay' -StartupType Manual -ErrorAction Continue
Set-Service -Name 'PolicyAgent' -StartupType Manual -ErrorAction Continue
Set-Service -Name 'Power' -StartupType Automatic -ErrorAction Continue
Set-Service -Name 'PrintNotify' -StartupType Manual -ErrorAction Continue
Set-Service -Name 'PrintWorkflowUserSvc_*' -StartupType Manual -ErrorAction Continue
Set-Service -Name 'ProfSvc' -StartupType Automatic -ErrorAction Continue
Set-Service -Name 'PushToInstall' -StartupType Manual -ErrorAction Continue
Set-Service -Name 'QWAVE' -StartupType Manual -ErrorAction Continue
Set-Service -Name 'RasAuto' -StartupType Manual -ErrorAction Continue
Set-Service -Name 'RasMan' -StartupType Manual -ErrorAction Continue
Set-Service -Name 'RemoteAccess' -StartupType Disabled -ErrorAction Continue
Set-Service -Name 'RemoteRegistry' -StartupType Disabled -ErrorAction Continue
Set-Service -Name 'RetailDemo' -StartupType Manual -ErrorAction Continue
Set-Service -Name 'RmSvc' -StartupType Manual -ErrorAction Continue
Set-Service -Name 'RpcEptMapper' -StartupType Automatic -ErrorAction Continue
Set-Service -Name 'RpcLocator' -StartupType Manual -ErrorAction Continue
Set-Service -Name 'RpcSs' -StartupType Automatic -ErrorAction Continue
Set-Service -Name 'SCPolicySvc' -StartupType Manual -ErrorAction Continue
Set-Service -Name 'SCardSvr' -StartupType Manual -ErrorAction Continue
Set-Service -Name 'SDRSVC' -StartupType Manual -ErrorAction Continue 
Set-Service -Name 'SEMgrSvc' -StartupType Manual -ErrorAction Continue
Set-Service -Name 'SENS' -StartupType Automatic -ErrorAction Continue
Set-Service -Name 'SNMPTRAP' -StartupType Manual -ErrorAction Continue
Set-Service -Name 'SNMPTrap' -StartupType Manual -ErrorAction Continue
Set-Service -Name 'SSDPSRV' -StartupType Manual -ErrorAction Continue
Set-Service -Name 'SamSs' -StartupType Automatic -ErrorAction Continue
Set-Service -Name 'ScDeviceEnum' -StartupType Manual -ErrorAction Continue
Set-Service -Name 'Schedule' -StartupType Automatic -ErrorAction Continue
Set-Service -Name 'SecurityHealthService' -StartupType Manual -ErrorAction Continue
Set-Service -Name 'Sense' -StartupType Manual -ErrorAction Continue
Set-Service -Name 'SensorDataService' -StartupType Manual -ErrorAction Continue
Set-Service -Name 'SensorService' -StartupType Manual -ErrorAction Continue
Set-Service -Name 'SensrSvc' -StartupType Manual -ErrorAction Continue
Set-Service -Name 'SessionEnv' -StartupType Manual -ErrorAction Continue
Set-Service -Name 'SgrmBroker' -StartupType Automatic -ErrorAction Continue
Set-Service -Name 'SharedAccess' -StartupType Manual -ErrorAction Continue
Set-Service -Name 'SharedRealitySvc' -StartupType Manual -ErrorAction Continue
Set-Service -Name 'ShellHWDetection' -StartupType Automatic -ErrorAction Continue
Set-Service -Name 'SmsRouter' -StartupType Manual -ErrorAction Continue
Set-Service -Name 'Spooler' -StartupType Manual -ErrorAction Continue
Set-Service -Name 'SstpSvc' -StartupType Manual -ErrorAction Continue
Set-Service -Name 'StateRepository' -StartupType Manual -ErrorAction Continue
Set-Service -Name 'StiSvc' -StartupType Manual -ErrorAction Continue
Set-Service -Name 'StorSvc' -StartupType Manual -ErrorAction Continue
Set-Service -Name 'SysMain' -StartupType Automatic -ErrorAction Continue
Set-Service -Name 'SystemEventsBroker' -StartupType Automatic -ErrorAction Continue
Set-Service -Name 'TabletInputService' -StartupType Manual -ErrorAction Continue
Set-Service -Name 'TapiSrv' -StartupType Manual -ErrorAction Continue
Set-Service -Name 'TermService' -StartupType Automatic -ErrorAction Continue
Set-Service -Name 'TextInputManagementService' -StartupType Manual -ErrorAction Continue
Set-Service -Name 'Themes' -StartupType Automatic -ErrorAction Continue
Set-Service -Name 'TieringEngineService' -StartupType Manual -ErrorAction Continue
Set-Service -Name 'TimeBroker' -StartupType Manual -ErrorAction Continue
Set-Service -Name 'TimeBrokerSvc' -StartupType Manual -ErrorAction Continue
Set-Service -Name 'TokenBroker' -StartupType Manual -ErrorAction Continue
Set-Service -Name 'TrkWks' -StartupType Automatic -ErrorAction Continue
Set-Service -Name 'TroubleshootingSvc' -StartupType Manual -ErrorAction Continue
Set-Service -Name 'TrustedInstaller' -StartupType Manual -ErrorAction Continue
Set-Service -Name 'UI0Detect' -StartupType Manual -ErrorAction Continue
Set-Service -Name 'UdkUserSvc_*' -StartupType Manual -ErrorAction Continue
Set-Service -Name 'UevAgentService' -StartupType Disabled -ErrorAction Continue
Set-Service -Name 'UmRdpService' -StartupType Manual -ErrorAction Continue
Set-Service -Name 'UnistoreSvc_*' -StartupType Manual -ErrorAction Continue
Set-Service -Name 'UserDataSvc_*' -StartupType Manual -ErrorAction Continue
Set-Service -Name 'UserManager' -StartupType Automatic -ErrorAction Continue
Set-Service -Name 'UsoSvc' -StartupType Manual -ErrorAction Continue
Set-Service -Name 'VGAuthService' -StartupType Automatic -ErrorAction Continue
Set-Service -Name 'VMTools' -StartupType Automatic -ErrorAction Continue
Set-Service -Name 'VSS' -StartupType Manual -ErrorAction Continue
Set-Service -Name 'VacSvc' -StartupType Manual -ErrorAction Continue
Set-Service -Name 'VaultSvc' -StartupType Automatic -ErrorAction Continue
Set-Service -Name 'W32Time' -StartupType Manual -ErrorAction Continue
Set-Service -Name 'WEPHOSTSVC' -StartupType Manual -ErrorAction Continue
Set-Service -Name 'WFDSConMgrSvc' -StartupType Manual -ErrorAction Continue
Set-Service -Name 'WMPNetworkSvc' -StartupType Manual -ErrorAction Continue
Set-Service -Name 'WManSvc' -StartupType Manual -ErrorAction Continue
Set-Service -Name 'WPDBusEnum' -StartupType Manual -ErrorAction Continue
Set-Service -Name 'WSService' -StartupType Manual -ErrorAction Continue
Set-Service -Name 'WSearch' -StartupType Disabled -ErrorAction Continue
Set-Service -Name 'WaaSMedicSvc' -StartupType Manual -ErrorAction Continue
Set-Service -Name 'WalletService' -StartupType Manual -ErrorAction Continue
Set-Service -Name 'WarpJITSvc' -StartupType Manual -ErrorAction Continue
Set-Service -Name 'WbioSrvc' -StartupType Manual -ErrorAction Continue
Set-Service -Name 'Wcmsvc' -StartupType Automatic -ErrorAction Continue
Set-Service -Name 'WcsPlugInService' -StartupType Manual -ErrorAction Continue
Set-Service -Name 'WdNisSvc' -StartupType Manual -ErrorAction Continue
Set-Service -Name 'WdiServiceHost' -StartupType Manual -ErrorAction Continue
Set-Service -Name 'WdiSystemHost' -StartupType Manual -ErrorAction Continue
Set-Service -Name 'WebClient' -StartupType Manual -ErrorAction Continue
Set-Service -Name 'Wecsvc' -StartupType Manual -ErrorAction Continue
Set-Service -Name 'WerSvc' -StartupType Manual -ErrorAction Continue
Set-Service -Name 'WiaRpc' -StartupType Manual -ErrorAction Continue
Set-Service -Name 'WinDefend' -StartupType Automatic -ErrorAction Continue
Set-Service -Name 'WinHttpAutoProxySvc' -StartupType Manual -ErrorAction Continue
Set-Service -Name 'WinRM' -StartupType Manual -ErrorAction Continue
Set-Service -Name 'Winmgmt' -StartupType Automatic -ErrorAction Continue
Set-Service -Name 'WlanSvc' -StartupType Automatic -ErrorAction Continue
Set-Service -Name 'WpcMonSvc' -StartupType Manual -ErrorAction Continue
Set-Service -Name 'WpnService' -StartupType Manual -ErrorAction Continue
Set-Service -Name 'WpnUserService_*' -StartupType Automatic -ErrorAction Continue
Set-Service -Name 'WwanSvc' -StartupType Manual -ErrorAction Continue
Set-Service -Name 'XblAuthManager' -StartupType Manual -ErrorAction Continue
Set-Service -Name 'XblGameSave' -StartupType Manual -ErrorAction Continue
Set-Service -Name 'XboxGipSvc' -StartupType Manual -ErrorAction Continue
Set-Service -Name 'XboxNetApiSvc' -StartupType Manual -ErrorAction Continue
Set-Service -Name 'autotimesvc' -StartupType Manual -ErrorAction Continue
Set-Service -Name 'bthserv' -StartupType Manual -ErrorAction Continue
Set-Service -Name 'camsvc' -StartupType Manual -ErrorAction Continue
Set-Service -Name 'cbdhsvc_*' -StartupType Manual -ErrorAction Continue
Set-Service -Name 'cloudidsvc' -StartupType Manual -ErrorAction Continue
Set-Service -Name 'dcsvc' -StartupType Manual -ErrorAction Continue
Set-Service -Name 'defragsvc' -StartupType Manual -ErrorAction Continue
Set-Service -Name 'diagnosticshub.standardcollector.service' -StartupType Manual -ErrorAction Continue
Set-Service -Name 'diagsvc' -StartupType Manual -ErrorAction Continue
Set-Service -Name 'dmwappushservice' -StartupType Manual -ErrorAction Continue
Set-Service -Name 'dot3svc' -StartupType Manual -ErrorAction Continue
Set-Service -Name 'edgeupdate' -StartupType Manual -ErrorAction Continue
Set-Service -Name 'edgeupdatem' -StartupType Manual -ErrorAction Continue
Set-Service -Name 'embeddedmode' -StartupType Manual -ErrorAction Continue
Set-Service -Name 'fdPHost' -StartupType Manual -ErrorAction Continue
Set-Service -Name 'fhsvc' -StartupType Manual -ErrorAction Continue
Set-Service -Name 'gpsvc' -StartupType Automatic -ErrorAction Continue
Set-Service -Name 'hidserv' -StartupType Manual -ErrorAction Continue
Set-Service -Name 'icssvc' -StartupType Manual -ErrorAction Continue
Set-Service -Name 'iphlpsvc' -StartupType Automatic -ErrorAction Continue
Set-Service -Name 'lfsvc' -StartupType Manual -ErrorAction Continue
Set-Service -Name 'lltdsvc' -StartupType Manual -ErrorAction Continue
Set-Service -Name 'lmhosts' -StartupType Manual -ErrorAction Continue
Set-Service -Name 'mpssvc' -StartupType Automatic -ErrorAction Continue
Set-Service -Name 'msiserver' -StartupType Manual -ErrorAction Continue
Set-Service -Name 'netprofm' -StartupType Manual -ErrorAction Continue
Set-Service -Name 'nsi' -StartupType Automatic -ErrorAction Continue
Set-Service -Name 'p2pimsvc' -StartupType Manual -ErrorAction Continue
Set-Service -Name 'p2psvc' -StartupType Manual -ErrorAction Continue
Set-Service -Name 'perceptionsimulation' -StartupType Manual -ErrorAction Continue
Set-Service -Name 'pla' -StartupType Manual -ErrorAction Continue
Set-Service -Name 'seclogon' -StartupType Manual -ErrorAction Continue
Set-Service -Name 'shpamsvc' -StartupType Disabled -ErrorAction Continue
Set-Service -Name 'smphost' -StartupType Manual -ErrorAction Continue
Set-Service -Name 'spectrum' -StartupType Manual -ErrorAction Continue
Set-Service -Name 'sppsvc' -StartupType Manual -ErrorAction Continue
Set-Service -Name 'ssh-agent' -StartupType Disabled -ErrorAction Continue
Set-Service -Name 'svsvc' -StartupType Manual -ErrorAction Continue
Set-Service -Name 'swprv' -StartupType Manual -ErrorAction Continue
Set-Service -Name 'tiledatamodelsvc' -StartupType Automatic -ErrorAction Continue
Set-Service -Name 'tzautoupdate' -StartupType Disabled -ErrorAction Continue
Set-Service -Name 'uhssvc' -StartupType Disabled -ErrorAction Continue
Set-Service -Name 'upnphost' -StartupType Manual -ErrorAction Continue
Set-Service -Name 'vds' -StartupType Manual -ErrorAction Continue
Set-Service -Name 'vm3dservice' -StartupType Manual -ErrorAction Continue
Set-Service -Name 'vmicguestinterface' -StartupType Manual -ErrorAction Continue
Set-Service -Name 'vmicheartbeat' -StartupType Manual -ErrorAction Continue
Set-Service -Name 'vmickvpexchange' -StartupType Manual -ErrorAction Continue
Set-Service -Name 'vmicrdv' -StartupType Manual -ErrorAction Continue
Set-Service -Name 'vmicshutdown' -StartupType Manual -ErrorAction Continue
Set-Service -Name 'vmictimesync' -StartupType Manual -ErrorAction Continue
Set-Service -Name 'vmicvmsession' -StartupType Manual -ErrorAction Continue
Set-Service -Name 'vmicvss' -StartupType Manual -ErrorAction Continue
Set-Service -Name 'vmvss' -StartupType Manual -ErrorAction Continue
Set-Service -Name 'wbengine' -StartupType Manual -ErrorAction Continue
Set-Service -Name 'wcncsvc' -StartupType Manual -ErrorAction Continue
Set-Service -Name 'webthreatdefsvc' -StartupType Manual -ErrorAction Continue
Set-Service -Name 'webthreatdefusersvc_*' -StartupType Automatic -ErrorAction Continue
Set-Service -Name 'wercplsupport' -StartupType Manual -ErrorAction Continue
Set-Service -Name 'wisvc' -StartupType Manual -ErrorAction Continue
Set-Service -Name 'wlidsvc' -StartupType Manual -ErrorAction Continue
Set-Service -Name 'wlpasvc' -StartupType Manual -ErrorAction Continue
Set-Service -Name 'wmiApSrv' -StartupType Manual -ErrorAction Continue
Set-Service -Name 'workfolderssvc' -StartupType Manual -ErrorAction Continue
Set-Service -Name 'wuauserv' -StartupType Manual -ErrorAction Continue
Set-Service -Name 'wudfsvc' -StartupType Manual -ErrorAction Continue
Stop-Transcript
   ]]>
  </File>

<!-- 7+ Windows Local Machine Registry Tweaks (CMD) -->
  <File path="C:\Windows\Setup\Scripts\localmachine.cmd">
   <![CDATA[
:: Disable Defender
reg add "HKLM\SYSTEM\CurrentControlSet\Services\Sense" /v Start /t REG_DWORD /d 4 /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\WdBoot" /v Start /t REG_DWORD /d 4 /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\WdFilter" /v Start /t REG_DWORD /d 4 /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\WdNisDrv" /v Start /t REG_DWORD /d 4 /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\WdNisSvc" /v Start /t REG_DWORD /d 4 /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\WinDefend" /v Start /t REG_DWORD /d 4 /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\MDCoreSvc" /v Start /t REG_DWORD /d 4 /f
reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Run" /v "SecurityHealth" /f
reg delete "HKCR\*\shellex\ContextMenuHandlers\EPP" /f
reg delete "HKCR\CLSID\{09A47860-11B0-4DA5-AFA5-26D86198A780}" /f
reg delete "HKCR\Directory\shellex\ContextMenuHandlers\EPP" /f
reg delete "HKCR\Drive\shellex\ContextMenuHandlers\EPP" /f
reg add "HKLM\SOFTWARE\Policies\Microsoft\Windows Defender Security Center\Virus and threat protection" /v UILockdown /t REG_DWORD /d 1 /f
reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer" /v "SmartScreenEnabled" /t REG_SZ /d "Off" /f
reg add "HKLM\SOFTWARE\Policies\Microsoft\Windows Defender" /v "PUAProtection" /t REG_DWORD /d 0 /f
reg add "HKLM\SOFTWARE\Policies\Microsoft\Windows Defender\MpEngine" /v "MpEnablePus" /t REG_DWORD /d 0 /f
reg add "HKLM\SOFTWARE\Policies\Microsoft\Windows Defender Security Center\App and Browser protection" /v "UILockdown" /t REG_DWORD /d 1 /f

:: Disable Smart Screen (Fixes Slow App Loading in Windows 11)
reg add "HKLM\SYSTEM\CurrentControlSet\Control\CI\Policy" /v "VerifiedAndReputablePolicyState" /t REG_DWORD /d 0 /f

:: Disable Reserved Storage
reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\ReserveManager" /v "ShippedWithReserves" /t REG_DWORD /d 0 /f

:: Hide Unused Windows Security Pages
reg add "HKLM\SOFTWARE\Policies\Microsoft\Windows Defender Security Center\Device performance and health" /v "UILockdown" /t REG_DWORD /d 1 /f
reg add "HKLM\SOFTWARE\Policies\Microsoft\Windows Defender Security Center\Family options" /v "UILockdown" /t REG_DWORD /d 1 /f
reg add "HKLM\SOFTWARE\Policies\Microsoft\Windows Defender Security Center\Account protection" /v "UILockdown" /t REG_DWORD /d 1 /f

:: Disable Core Isolation (To Improve Performance)
reg add "HKLM\SYSTEM\CurrentControlSet\Control\DeviceGuard\Scenarios\HypervisorEnforcedCodeIntegrity" /v Enabled /t REG_DWORD /d 0 /f
reg add "HKLM\SOFTWARE\Policies\Microsoft\Windows Defender Security Center\Device security" /v "UILockdown" /t REG_DWORD /d 1 /f

:: Disable Malicious Software Removal Tool From Installing 
reg add "HKLM\SOFTWARE\Policies\Microsoft\MRT" /v "DontOfferThroughWUAU" /t REG_DWORD /d 1 /f

:: Displays Camera On/Off Notification for Privacy
reg add "HKLM\SOFTWARE\Microsoft\OEM\Device\Capture" /v "NoPhysicalCameraLED" /t REG_DWORD /d 1 /f

:: Disable Auto Start on BSOD and Enable Detailed BSOD
reg add "HKLM\SYSTEM\CurrentControlSet\Control\CrashControl" /v "AutoReboot" /t REG_DWORD /d 0 /f
reg add "HKLM\SYSTEM\CurrentControlSet\Control\CrashControl" /v "DisplayParameters" /t REG_DWORD /d 1 /f

:: Add Shivaay OS in OEM Info
reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\OEMInformation" /v "Model" /t REG_SZ /d "Shivaay OS - V3" /f
reg add "HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion" /v "RegisteredOrganization" /t REG_SZ /d "Shivaay OS - V3" /f
 
:: Disable Multi-Plane Overlay (MPO) (Fixes Lags or Glitches On Nvidia or AMD GPUs)
reg add "HKLM\SOFTWARE\Microsoft\Windows\Dwm" /v OverlayTestMode /t REG_DWORD /d 5 /f

:: Bypasses Microsoft Account Creation
reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\OOBE" /v BypassNRO /t REG_DWORD /d 1 /f

:: Hide Settings Home Page
reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\Explorer" /v SettingsPageVisibility /t REG_SZ /d "hide:home" /f

:: Delete Microsoft Edge Registry Entries
reg delete "HKLM\SOFTWARE\WOW6432Node\Microsoft\Windows\CurrentVersion\Uninstall\Microsoft Edge" /f
reg delete "HKLM\SOFTWARE\WOW6432Node\Microsoft\Windows\CurrentVersion\Uninstall\Microsoft Edge Update" /f
reg delete "HKLM\SOFTWARE\WOW6432Node\Microsoft\Windows\CurrentVersion\Uninstall\Microsoft EdgeWebview" /f
reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Appx\AppxAllUserStore\Applications\Microsoft.MicrosoftEdge.Stable_124.0.2478.105_neutral__8wekyb3d8bbwe" /f
reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Appx\AppxAllUserStore\InboxApplications\Microsoft.MicrosoftEdge_44.19041.1266.0_neutral__8wekyb3d8bbwe" /f
reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Appx\AppxAllUserStore\InboxApplications\Microsoft.MicrosoftEdgeDevToolsClient_10.0.19041.1023_neutral__8wekyb3d8bbwe" /f
reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Appx\AppxAllUserStore\S-1-5-21-2466455740-832722602-188176761-1001\Microsoft.MicrosoftEdge.Stable_124.0.2478.105_neutral__8wekyb3d8bbwe" /f
reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Appx\AppxAllUserStore\S-1-5-21-2466455740-832722602-188176761-1001\Microsoft.MicrosoftEdge_44.19041.1266.0_neutral__8wekyb3d8bbwe" /f
reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Appx\AppxAllUserStore\S-1-5-21-2466455740-832722602-188176761-1001\Microsoft.MicrosoftEdgeDevToolsClient_10.0.19041.1023_neutral__8wekyb3d8bbwe" /f
reg delete "HKLM\SOFTWARE\Classes\MSEdgeHTM" /f
reg delete "HKLM\SOFTWARE\Classes\MSEdgeMHT" /f
reg delete "HKLM\SOFTWARE\Classes\MSEdgePDF" /f

:: Disable User Account Control Temporarily
reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System" /v EnableLUA /t REG_DWORD /d 0 /f

:: Disable Windows Spotlight and set the normal Windows Picture as the desktop background
reg add "HKLM\SOFTWARE\Policies\Microsoft\Windows\CloudContent" /v DisableWindowsSpotlightOnLockScreen /t REG_DWORD /d 1 /f
reg add "HKLM\SOFTWARE\Policies\Microsoft\Windows\CloudContent" /v DisableWindowsConsumerFeatures /t REG_DWORD /d 1 /f
:: Disable Windows Spotlight on Settings
reg add "HKLM\SOFTWARE\Policies\Microsoft\Windows\CloudContent" /v DisableWindowsSpotlightActiveUser /t REG_DWORD /d 1 /f

:: Prevents Dev Home Installation
reg delete "HKLM\SOFTWARE\Microsoft\WindowsUpdate\Orchestrator\UScheduler_Oobe\DevHomeUpdate" /f

:: Prevents New Outlook for Windows Installation
reg delete "HKLM\SOFTWARE\Microsoft\WindowsUpdate\Orchestrator\UScheduler_Oobe\OutlookUpdate" /f

:: Prevents Chat Auto Installation and Removes Chat Icon
reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Communications" /v ConfigureChatAutoInstall /t REG_DWORD /d 0 /f
reg add "HKLM\SOFTWARE\Policies\Microsoft\Windows\Windows Chat" /v "ChatIcon" /t REG_DWORD /d 3 /f

:: Start Menu Customization
reg add "HKLM\SOFTWARE\Microsoft\PolicyManager\current\device\Start" /v ConfigureStartPins /t REG_SZ /d "{ \"pinnedList\": [] }" /f
reg add "HKLM\SOFTWARE\Microsoft\PolicyManager\current\device\Start" /v ConfigureStartPins_ProviderSet /t REG_DWORD /d 1 /f
reg add "HKLM\SOFTWARE\Microsoft\PolicyManager\current\device\Start" /v ConfigureStartPins_WinningProvider /t REG_SZ /d B5292708-1619-419B-9923-E5D9F3925E71 /f
reg add "HKLM\SOFTWARE\Microsoft\PolicyManager\providers\B5292708-1619-419B-9923-E5D9F3925E71\default\Device\Start" /v ConfigureStartPins /t REG_SZ /d "{ \"pinnedList\": [] }" /f
reg add "HKLM\SOFTWARE\Microsoft\PolicyManager\providers\B5292708-1619-419B-9923-E5D9F3925E71\default\Device\Start" /v ConfigureStartPins_LastWrite /t REG_DWORD /d 1 /f

:: Hide Removable Drives (This PC can show this drives)
reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\Desktop\NameSpace\DelegateFolders\{F5FB2C77-0E2F-4A16-A381-3E560C68BC83}" /f
reg delete "HKLM\SOFTWARE\WOW6432Node\Microsoft\Windows\CurrentVersion\Explorer\Desktop\NameSpace\DelegateFolders\{F5FB2C77-0E2F-4A16-A381-3E560C68BC83}\{F5FB2C77-0E2F-4A16-A381-3E560C68BC83}" /f

:: Enable Long File Paths with Up to 32,767 Characters
reg add "HKLM\SYSTEM\CurrentControlSet\Control\FileSystem" /v LongPathsEnabled /t REG_DWORD /d 1 /f

:: Disable News and Interests
reg add "HKLM\SOFTWARE\Policies\Microsoft\Dsh" /v AllowNewsAndInterests /t REG_DWORD /d 0 /f

:: Disable Windows Consumer Features Like App Promotions etc.
reg add "HKLM\Software\Policies\Microsoft\Windows\CloudContent" /v "DisableWindowsConsumerFeatures" /t REG_DWORD /d 0 /f

:: Disable Bitlocker Auto Encryption on Windows 11 24H2 and Onwards
reg add "HKLM\SYSTEM\CurrentControlSet\Control\BitLocker" /v "PreventDeviceEncryption" /t REG_DWORD /d 1 /f
reg add "HKLM\SOFTWARE\Policies\Microsoft\Windows\EnhancedStorageDevices" /v TCGSecurityActivationDisabled /t REG_DWORD /d 1 /f

:: Sets Windows Update to Only Install Security Updates and Delay Features Updates for 1 Year
reg add "HKLM\SOFTWARE\Policies\Microsoft\Windows\WindowsUpdate\AU" /v AUOptions /t REG_DWORD /d 3 /f
reg add "HKLM\SOFTWARE\Policies\Microsoft\Windows\WindowsUpdate" /v DeferFeatureUpdates /t REG_DWORD /d 1 /f
reg add "HKLM\SOFTWARE\Policies\Microsoft\Windows\WindowsUpdate" /v DeferFeatureUpdatesPeriodInDays /t REG_DWORD /d 365 /f
reg add "HKLM\SOFTWARE\Policies\Microsoft\Windows\WindowsUpdate" /v DeferQualityUpdates /t REG_DWORD /d 1 /f
reg add "HKLM\SOFTWARE\Policies\Microsoft\Windows\WindowsUpdate" /v DeferQualityUpdatesPeriodInDays /t REG_DWORD /d 365 /f

:: Disable Cortana
reg add "HKLM\Software\Policies\Microsoft\Windows\Windows Search" /v AllowCortana /t REG_DWORD /d 0 /f

:: Disable Activity History
reg add "HKLM\SOFTWARE\Policies\Microsoft\Windows\System" /v EnableActivityFeed /t REG_DWORD /d 0 /f
reg add "HKLM\SOFTWARE\Policies\Microsoft\Windows\System" /v PublishUserActivities /t REG_DWORD /d 0 /f
reg add "HKLM\SOFTWARE\Policies\Microsoft\Windows\System" /v UploadUserActivities /t REG_DWORD /d 0 /f

:: Disable Hibernation (Takes 40% space of RAM also does not make much difference in Booting for SSD Users)
powercfg /hibernate off

:: Disable Location Tracking
reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\CapabilityAccessManager\ConsentStore\location" /v Value /t REG_SZ /d Deny /f
reg add "HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Sensor\Overrides\{BFA794E4-F964-4FDB-90F6-51056BFE4B44}" /v SensorPermissionState /t REG_DWORD /d 0 /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\lfsvc\Service\Configuration" /v Status /t REG_DWORD /d 0 /f
reg add "HKLM\SYSTEM\Maps" /v AutoUpdateEnabled /t REG_DWORD /d 0 /f

:: Disable Telemetry
reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\DataCollection" /v AllowTelemetry /t REG_DWORD /d 0 /f
reg add "HKLM\SOFTWARE\Policies\Microsoft\Windows\DataCollection" /v AllowTelemetry /t REG_DWORD /d 0 /f

:: Disable Windows Ink Workspace
reg add "HKLM\SOFTWARE\Policies\Microsoft\WindowsInkWorkspace" /v AllowWindowsInkWorkspace /t REG_DWORD /d 0 /f

:: Disable Feedback Notifications
reg add "HKLM\SOFTWARE\Policies\Microsoft\Windows\DataCollection" /v DoNotShowFeedbackNotifications /t REG_DWORD /d 1 /f

:: Disable the Advertising ID for All Users
reg add "HKLM\SOFTWARE\Policies\Microsoft\Windows\AdvertisingInfo" /v DisabledByGroupPolicy /t REG_DWORD /d 1 /f

:: Disable Windows Error Reporting
reg add "HKLM\SOFTWARE\Microsoft\Windows\Windows Error Reporting" /v Disabled /t REG_DWORD /d 1 /f

:: Disable Delivery Optimization
reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\DeliveryOptimization\Config" /v DODownloadMode /t REG_DWORD /d 0 /f

:: Disable Remote Assistance
reg add "HKLM\SYSTEM\CurrentControlSet\Control\Remote Assistance" /v fAllowToGetHelp /t REG_DWORD /d 0 /f

:: Search Windows Update for Drivers First
reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\DriverSearching" /v SearchOrderConfig /t REG_DWORD /d 1 /f

:: Gives Multimedia Applications like Games and Video Editing a Higher Priority
reg add "HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Multimedia\SystemProfile" /v SystemResponsiveness /t REG_DWORD /d 0 /f
reg add "HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Multimedia\SystemProfile" /v NetworkThrottlingIndex /t REG_DWORD /d 10 /f

:: Controls whether the memory page file is cleared at shutdown. Value 0 means it will not be cleared, speeding up shutdown.
reg add "HKLM\SYSTEM\CurrentControlSet\Control\Session Manager\Memory Management" /v ClearPageFileAtShutdown /t REG_DWORD /d 0 /f

:: Enables NDU (Network Diagnostic Usage) Service on Startup
reg add "HKLM\SYSTEM\ControlSet001\Services\Ndu" /v Start /t REG_DWORD /d 2 /f

:: Increases IRP stack size to 30 for the LanmanServer service to Improve Network Performance and Stability
reg add "HKLM\SYSTEM\CurrentControlSet\Services\LanmanServer\Parameters" /v IRPStackSize /t REG_DWORD /d 30 /f

:: Hides the Meet Now Button on the Taskbar
reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\Explorer" /v HideSCAMeetNow /t REG_DWORD /d 1 /f

:: Gives Graphics Cards a Higher Priority for Gaming
reg add "HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Multimedia\SystemProfile\Tasks\Games" /v "GPU Priority" /t REG_DWORD /d 8 /f

:: Gives the CPU a Higher Priority for Gaming
reg add "HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Multimedia\SystemProfile\Tasks\Games" /v Priority /t REG_DWORD /d 6 /f

:: Gives Games a higher priority in the system scheduling
reg add "HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Multimedia\SystemProfile\Tasks\Games" /v "Scheduling Category" /t REG_SZ /d "High" /f

:: Fix Managed by your organization in Edge
reg delete "HKLM\SOFTWARE\Policies\Microsoft\Edge" /f

:: Set Registry Keys to Disable Wifi-Sense
reg add "HKLM\Software\Microsoft\PolicyManager\default\WiFi\AllowWiFiHotSpotReporting" /v Value /t REG_DWORD /d 0 /f
reg add "HKLM\Software\Microsoft\PolicyManager\default\WiFi\AllowAutoConnectToWiFiSenseHotspots" /v Value /t REG_DWORD /d 0 /f

:: Disable Xbox GameDVR
reg add "HKLM\SOFTWARE\Policies\Microsoft\Windows\GameDVR" /v AllowGameDVR /t REG_DWORD /d 0 /f

:: Disable Tablet Mode
reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\ImmersiveShell" /v TabletMode /t REG_DWORD /d 0 /f

:: Always go to desktop mode on sign-in
reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\ImmersiveShell" /v SignInMode /t REG_DWORD /d 1 /f

:: Disable "Use my sign-in info to automatically finish setting up my device after an update or restart"
reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System" /v DisableAutomaticRestartSignOn /t REG_DWORD /d 1 /f

:: Disable OneDrive Automatic Backups of Important Folders (Documents, Pictures etc.)
reg add "HKLM\SOFTWARE\Policies\Microsoft\OneDrive" /v KFMBlockOptIn /t REG_DWORD /d 1 /f
reg add "HKLM\SOFTWARE\Policies\Microsoft\Windows\OneDrive" /v DisableFileSyncNGSC /t REG_DWORD /d 1 /f

:: Disable the "Push To Install" feature in Windows
reg add "HKLM\SOFTWARE\Policies\Microsoft\PushToInstall" /v "DisablePushToInstall" /t REG_DWORD /d 1 /f

:: Disable Consumer Account State Content
reg add "HKLM\SOFTWARE\Policies\Microsoft\Windows\CloudContent" /v "DisableConsumerAccountStateContent" /t REG_DWORD /d 1 /f

:: Disable Cloud Optimized Content
reg add "HKLM\SOFTWARE\Policies\Microsoft\Windows\CloudContent" /v "DisableCloudOptimizedContent" /t REG_DWORD /d 1 /f

:: Deleting Application Compatibility Appraiser
reg delete "HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Schedule\TaskCache\Tasks\{0600DD45-FAF2-4131-A006-0B17509B9F78}" /f

:: Deleting Customer Experience Improvement Program
reg delete "HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Schedule\TaskCache\Tasks\{4738DE7A-BCC1-4E2D-B1B0-CADB044BFA81}" /f
reg delete "HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Schedule\TaskCache\Tasks\{6FAC31FA-4A85-4E64-BFD5-2154FF4594B3}" /f
reg delete "HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Schedule\TaskCache\Tasks\{FC931F16-B50A-472E-B061-B6F79A71EF59}" /f

:: Disable Recent Items - 1
reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\Explorer" /v "NoStartMenuMFUprogramsList" /t REG_DWORD /d "1" /f
reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\Explorer" /v "NoRecentDocsHistory" /t REG_DWORD /d "1" /f
reg add "HKLM\SOFTWARE\Policies\Microsoft\Windows\Explorer" /v "ShowOrHideMostUsedApps" /t REG_DWORD /d "1" /f
reg add "HKLM\SOFTWARE\Policies\Microsoft\Windows\Explorer" /v "HideRecentlyAddedApps" /t REG_DWORD /d "1" /f

:: Deleting Program Data Updater
reg delete "HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Schedule\TaskCache\Tasks\{0671EB05-7D95-4153-A32B-1426B9FE61DB}" /f

:: Deleting autochk proxy
reg delete "HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Schedule\TaskCache\Tasks\{87BF85F4-2CE1-4160-96EA-52F554AA28A2}" /f
reg delete "HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Schedule\TaskCache\Tasks\{8A9C643C-3D74-4099-B6BD-9C6D170898B1}" /f

:: Deleting QueueReporting
reg delete "HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Schedule\TaskCache\Tasks\{E3176A65-4E44-4ED3-AA73-3283660ACB9C}" /f

:: Block Automatic Upgrade from Windows 10 22H2 to Windows 11 Although Manual Upgrade is Still Allowed - Credit CyberCPU Tech
reg add "HKLM\SOFTWARE\Policies\Microsoft\Windows\WindowsUpdate" /v "TargetReleaseVersion" /t REG_DWORD /d 1 /f
reg add "HKLM\SOFTWARE\Policies\Microsoft\Windows\WindowsUpdate" /v "TargetReleaseVersionInfo" /t REG_SZ /d "22H2" /f
reg add "HKLM\SOFTWARE\Policies\Microsoft\Windows\WindowsUpdate" /v "ProductVersion" /t REG_SZ /d "Windows 10" /f

:: Enable Verbose Status Messages
reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System" /v "verbosestatus" /t REG_DWORD /d 1 /f

:: Blocks the “Allow my organization to manage my device” and “No, sign in to this app only” pop-up message.
reg add "HKLM\SOFTWARE\Policies\Microsoft\Windows\WorkplaceJoin" /v BlockAADWorkplaceJoin /t REG_DWORD /d 1 /f
 ]]>
  </File>

<!-- 8+ Windows Reg File Tweaks (Context Menu) -->
<!-- Adds Items to Right-Click Context Menu -->
  <File path="C:\Windows\Setup\Scripts\contextmenu.reg">
   <![CDATA[
Windows Registry Editor Version 5.00

; Adds "Take Ownership" to the Right Click Context Menu
[-HKEY_CLASSES_ROOT\*\shell\TakeOwnership]
[-HKEY_CLASSES_ROOT\*\shell\runas]
[HKEY_CLASSES_ROOT\*\shell\TakeOwnership]
@="Take Ownership"
"Extended"=-
"HasLUAShield"=""
"NoWorkingDirectory"=""
"NeverDefault"=""
[HKEY_CLASSES_ROOT\*\shell\TakeOwnership\command]
@="powershell -windowstyle hidden -command \"Start-Process cmd -ArgumentList '/c takeown /f \\\"%1\\\" && icacls \\\"%1\\\" /grant *S-1-3-4:F /t /c /l' -Verb runAs\""
"IsolatedCommand"= "powershell -windowstyle hidden -command \"Start-Process cmd -ArgumentList '/c takeown /f \\\"%1\\\" && icacls \\\"%1\\\" /grant *S-1-3-4:F /t /c /l' -Verb runAs\""
[HKEY_CLASSES_ROOT\Directory\shell\TakeOwnership]
@="Take Ownership"
"AppliesTo"="NOT (System.ItemPathDisplay:=\"C:\\Users\" OR System.ItemPathDisplay:=\"C:\\ProgramData\" OR System.ItemPathDisplay:=\"C:\\Windows\" OR System.ItemPathDisplay:=\"C:\\Windows\\System32\" OR System.ItemPathDisplay:=\"C:\\Program Files\" OR System.ItemPathDisplay:=\"C:\\Program Files (x86)\")"
"Extended"=-
"HasLUAShield"=""
"NoWorkingDirectory"=""
"Position"="middle"
[HKEY_CLASSES_ROOT\Directory\shell\TakeOwnership\command]
@="powershell -windowstyle hidden -command \"$Y = ($null | choice).Substring(1,1); Start-Process cmd -ArgumentList ('/c takeown /f \\\"%1\\\" /r /d ' + $Y + ' && icacls \\\"%1\\\" /grant *S-1-3-4:F /t /c /l /q') -Verb runAs\""
"IsolatedCommand"="powershell -windowstyle hidden -command \"$Y = ($null | choice).Substring(1,1); Start-Process cmd -ArgumentList ('/c takeown /f \\\"%1\\\" /r /d ' + $Y + ' && icacls \\\"%1\\\" /grant *S-1-3-4:F /t /c /l /q') -Verb runAs\""
[HKEY_CLASSES_ROOT\Drive\shell\runas]
@="Take Ownership"
"Extended"=-
"HasLUAShield"=""
"NoWorkingDirectory"=""
"Position"="middle"
"AppliesTo"="NOT (System.ItemPathDisplay:=\"C:\\\")"
[HKEY_CLASSES_ROOT\Drive\shell\runas\command]
@="cmd /c takeown /f \"%1\\\" /r /d y && icacls \"%1\\\" /grant *S-1-3-4:F /t /c"
"IsolatedCommand"="cmd /c takeown /f \"%1\\\" /r /d y && icacls \"%1\\\" /grant *S-1-3-4:F /t /c"

; Add Compress to.. in Old Context Menu
[HKEY_CLASSES_ROOT\*\shell\CompressToFullMenu_ForOldContextMenu]
"CommandStateSync"=""
"ExplorerCommandHandler"="{7AE6900F-6EB0-44A2-9CA1-DB2F7EF352AF}"
"MUIVerb"="@Windows.UI.FileExplorer.dll,-51797"
[HKEY_CLASSES_ROOT\Folder\shell\CompressToFullMenu_ForOldContextMenu]
"CommandStateSync"=""
"ExplorerCommandHandler"="{7AE6900F-6EB0-44A2-9CA1-DB2F7EF352AF}"
"MUIVerb"="@Windows.UI.FileExplorer.dll,-51797"

; Add Run as Admin for PowerShell Script 
[-HKEY_CLASSES_ROOT\.ps1]
[HKEY_CLASSES_ROOT\.ps1]
@="Microsoft.PowerShellScript.1"
[-HKEY_CLASSES_ROOT\Microsoft.PowerShellScript.1]
[HKEY_CLASSES_ROOT\Microsoft.PowerShellScript.1]
"EditFlags"=dword:00020000
"FriendlyTypeName"=hex(2):40,00,22,00,25,00,73,00,79,00,73,00,74,00,65,00,6d,\
  00,72,00,6f,00,6f,00,74,00,25,00,5c,00,73,00,79,00,73,00,74,00,65,00,6d,00,\
  33,00,32,00,5c,00,77,00,69,00,6e,00,64,00,6f,00,77,00,73,00,70,00,6f,00,77,\
  00,65,00,72,00,73,00,68,00,65,00,6c,00,6c,00,5c,00,76,00,31,00,2e,00,30,00,\
  5c,00,70,00,6f,00,77,00,65,00,72,00,73,00,68,00,65,00,6c,00,6c,00,2e,00,65,\
  00,78,00,65,00,22,00,2c,00,2d,00,31,00,30,00,33,00,00,00
[HKEY_CLASSES_ROOT\Microsoft.PowerShellScript.1\DefaultIcon]
@="\"C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell_ise.exe\",1"
[HKEY_CLASSES_ROOT\Microsoft.PowerShellScript.1\Shell]
@="Open"
[HKEY_CLASSES_ROOT\Microsoft.PowerShellScript.1\Shell\0]
"MUIVerb"=hex(2):40,00,22,00,25,00,73,00,79,00,73,00,74,00,65,00,6d,00,72,00,\
  6f,00,6f,00,74,00,25,00,5c,00,73,00,79,00,73,00,74,00,65,00,6d,00,33,00,32,\
  00,5c,00,77,00,69,00,6e,00,64,00,6f,00,77,00,73,00,70,00,6f,00,77,00,65,00,\
  72,00,73,00,68,00,65,00,6c,00,6c,00,5c,00,76,00,31,00,2e,00,30,00,5c,00,70,\
  00,6f,00,77,00,65,00,72,00,73,00,68,00,65,00,6c,00,6c,00,2e,00,65,00,78,00,\
  65,00,20,00,22,00,2c,00,2d,00,31,00,30,00,38,00,00,00
[HKEY_CLASSES_ROOT\Microsoft.PowerShellScript.1\Shell\0\Command]
@="\"C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe\" \"-Command\" \"if((Get-ExecutionPolicy ) -ne 'AllSigned') { Set-ExecutionPolicy -Scope Process Bypass }; & '%1'\""
[HKEY_CLASSES_ROOT\Microsoft.PowerShellScript.1\Shell\Edit]
"NoSmartScreen"=""
[HKEY_CLASSES_ROOT\Microsoft.PowerShellScript.1\Shell\Edit\Command]
@="\"C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell_ise.exe\" \"%1\""
[HKEY_CLASSES_ROOT\Microsoft.PowerShellScript.1\Shell\Open\Command]
@="\"C:\\Windows\\System32\\notepad.exe\" \"%1\""
[-HKEY_CLASSES_ROOT\SystemFileAssociations\.ps1]
[-HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Explorer\FileExts\.ps1]
[HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Explorer\FileExts\.ps1\OpenWithList]
"a"="powershell_ise.exe"
"b"="bca"
"c"="powershell.exe"
"d"="abcd"
"e"="abcde"
"MRUList"="fabcde"
"f"="notepad.exe"
[HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Explorer\FileExts\.ps1\OpenWithProgids]
"Microsoft.PowerShellScript.1"=hex(0):
[-HKEY_CLASSES_ROOT\Microsoft.PowerShellScript.1\Shell\runas]
[HKEY_CLASSES_ROOT\Microsoft.PowerShellScript.1\Shell\runas]
"HasLUAShield"=""
[HKEY_CLASSES_ROOT\Microsoft.PowerShellScript.1\Shell\runas\command]
@="\"C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe\" \"-Command\" \"if((Get-ExecutionPolicy ) -ne 'AllSigned') { Set-ExecutionPolicy -Scope Process Bypass }; & '%1'\""
   ]]>
  </File>

<!-- 9+ Windows Current User Registry Tweaks (CMD) -->
  <File path="C:\Windows\Setup\Scripts\currentuser.cmd">
   <![CDATA[

:: Create and apply custom Power Plan Shivaay
powercfg -restoredefaultschemes
powercfg -duplicatescheme e9a42b02-d5df-448d-aa00-03f14749eb61 3ff9831b-6f80-4830-8178-736cd4229e7b
powercfg -changename 3ff9831b-6f80-4830-8178-736cd4229e7b "Shivaay - Unleash the Power Within" "Inspired by the strength of Shiva, this plan activates all CPU cores for unmatched performance.."
powercfg -s 3ff9831b-6f80-4830-8178-736cd4229e7b
powercfg -setacvalueindex scheme_current sub_processor PERFINCPOL 2
powercfg -setacvalueindex scheme_current sub_processor PERFDECPOL 1
powercfg -setacvalueindex scheme_current sub_processor PERFINCTHRESHOLD 10
powercfg -setacvalueindex scheme_current sub_processor PERFDECTHRESHOLD 8
powercfg -setacvalueindex scheme_current sub_processor CPMINCORES 100
powercfg -setacvalueindex scheme_current sub_processor CPMINCORES1 100

:: Disable Processor Performance Boost mode (To avoid heating issues or thermal throttling)
powercfg -setacvalueindex scheme_current sub_processor PERFBOOSTMODE 0
powercfg -setdcvalueindex scheme_current sub_processor PERFBOOSTMODE 0
powercfg /setactive scheme_current

:: Disable Storage Sense
reg add "HKCU\Software\Microsoft\Windows\CurrentVersion\StorageSense\Parameters\StoragePolicy" /v "01" /t REG_DWORD /d 0 /f

:: Disabling the Delivery of Personalized or Suggested Content Like App Suggestions, Tips, and Advertisements in Windows
reg add "HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\ContentDeliveryManager" /v "ContentDeliveryAllowed" /t REG_DWORD /d 0 /f
reg add "HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\ContentDeliveryManager" /v "FeatureManagementEnabled" /t REG_DWORD /d 0 /f
reg add "HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\ContentDeliveryManager" /v "OEMPreInstalledAppsEnabled" /t REG_DWORD /d 0 /f
reg add "HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\ContentDeliveryManager" /v "PreInstalledAppsEnabled" /t REG_DWORD /d 0 /f
reg add "HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\ContentDeliveryManager" /v "PreInstalledAppsEverEnabled" /t REG_DWORD /d 0 /f
reg add "HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\ContentDeliveryManager" /v "SilentInstalledAppsEnabled" /t REG_DWORD /d 0 /f
reg add "HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\ContentDeliveryManager" /v "RotatingLockScreenEnabled" /t REG_DWORD /d 0 /f
reg add "HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\ContentDeliveryManager" /v "RotatingLockScreenOverlayEnabled" /t REG_DWORD /d 0 /f
reg add "HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\ContentDeliveryManager" /v "SoftLandingEnabled" /t REG_DWORD /d 0 /f
reg add "HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\ContentDeliveryManager" /v "SubscribedContentEnabled" /t REG_DWORD /d 0 /f
reg add "HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\ContentDeliveryManager" /v "SubscribedContent-310093Enabled" /t REG_DWORD /d 0 /f
reg add "HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\ContentDeliveryManager" /v "SubscribedContent-338387Enabled" /t REG_DWORD /d 0 /f
reg add "HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\ContentDeliveryManager" /v "SubscribedContent-338388Enabled" /t REG_DWORD /d 0 /f
reg add "HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\ContentDeliveryManager" /v "SubscribedContent-338389Enabled" /t REG_DWORD /d 0 /f
reg add "HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\ContentDeliveryManager" /v "SubscribedContent-338393Enabled" /t REG_DWORD /d 0 /f
reg add "HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\ContentDeliveryManager" /v "SubscribedContent-353698Enabled" /t REG_DWORD /d 0 /f
reg add "HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\ContentDeliveryManager" /v "SubscribedContent-353694Enabled" /t REG_DWORD /d 0 /f
reg add "HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\ContentDeliveryManager" /v "SubscribedContent-353696Enabled" /t REG_DWORD /d 0 /f
reg add "HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\ContentDeliveryManager" /v "SystemPaneSuggestionsEnabled" /t REG_DWORD /d 0 /f
reg add "HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Privacy" /v TailoredExperiencesWithDiagnosticDataEnabled /t REG_DWORD /d 0 /f
reg add "HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Privacy" /v IsMiEnabled /t REG_DWORD /d 0 /f
reg delete "HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\ContentDeliveryManager\Subscriptions" /f
reg delete "HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\ContentDeliveryManager\SuggestedApps" /f
reg add "HKCU\SOFTWARE\Microsoft\Speech_OneCore\Settings\OnlineSpeechPrivacy" /v "HasAccepted" /t REG_DWORD /d 0 /f

:: Disable Recent Items - 2
reg add "HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\Explorer" /v "NoInstrumentation" /t REG_DWORD /d "1" /f
reg add "HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\Explorer" /v "ClearRecentDocsOnExit" /t REG_DWORD /d "1" /f
reg add "HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\Explorer" /v "NoRecentDocsHistory" /t REG_DWORD /d "1" /f
reg add "HKCU\SOFTWARE\Policies\Microsoft\Windows\Explorer" /v "NoRemoteDestinations" /t REG_DWORD /d "1" /f
reg add "HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\Advanced" /v "Start_TrackProgs" /t REG_DWORD /d "0" /f
reg add "HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\Advanced" /v "Start_TrackDocs" /t REG_DWORD /d "0" /f

:: Removes Copilot
reg add "HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Runonce" /v "UninstallCopilot" /t REG_SZ /d "" /f
reg add "HKCU\SOFTWARE\Policies\Microsoft\Windows\WindowsCopilot" /v TurnOffWindowsCopilot /t REG_DWORD /d 1 /f

:: Removes Store Banner in Notepad
reg add "HKCU\SOFTWARE\Microsoft\Notepad" /v ShowStoreBanner /t REG_DWORD /d 0 /f

:: Removes OneDrive
reg delete "HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Run" /v OneDriveSetup /f

:: Display only Search Icon on Taskbar
reg add "HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Search" /v SearchboxTaskbarMode /t REG_DWORD /d 1 /f

:: Show More Details in File Explorer
reg add "HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer\OperationStatusManager" /v "EnthusiastMode" /t REG_DWORD /d 1 /f

:: Enable Item Checkboxes in File Explorer
reg add "HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced" /v AutoCheckSelect /t REG_DWORD /d 1 /f

:: Remove Recycle Bin Shortcut from Desktop
reg add "HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer\HideDesktopIcons\NewStartPanel" /v "{645FF040-5081-101B-9F08-00AA002F954E}" /t REG_DWORD /d 1 /f

:: Pin Recycle Bin In File Explorer.
reg add "HKCU\Software\Classes\CLSID\{645FF040-5081-101B-9F08-00AA002F954E}" /v System.IsPinnedToNameSpaceTree /t REG_DWORD /d 1 /f

:: Turn on Game Mode
reg add "HKCU\Software\Microsoft\GameBar" /v "AllowAutoGameMode" /t REG_DWORD /d 1 /f
reg add "HKCU\Software\Microsoft\GameBar" /v "AutoGameModeEnabled" /t REG_DWORD /d 1 /f

:: Disable Recommendations in the Start Menu
reg add "HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced" /v Start_IrisRecommendations /t REG_DWORD /d 0 /f

:: Hides or Removes People from Taskbar
reg add "HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\Advanced\People" /v PeopleBand /t REG_DWORD /d 0 /f

:: Hides Task View Button on Taskbar
reg add "HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\Advanced" /v ShowTaskViewButton /t REG_DWORD /d 0 /f

:: Hides and Removes News and Interests from PC and Taskbar
reg add "HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Feeds" /v ShellFeedsTaskbarViewMode /t REG_DWORD /d 2 /f
reg add "HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Feeds" /v ShellFeedsEnabled /t REG_DWORD /d 0 /f
reg add "HKCU\SOFTWARE\Policies\Microsoft\Windows\Windows Feeds" /v EnableFeeds /t REG_DWORD /d 0 /f

:: Disable User Account Sync
reg add "HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Privacy" /v SettingSyncEnabled /t REG_DWORD /d 0 /f

:: File Explorer Customization
:: Hide Network Navigation Pane
reg add "HKCU\SOFTWARE\Classes\CLSID\{F02C1A0D-BE21-4350-88B0-7367FC96EF3C}" /v System.IsPinnedToNameSpaceTree /t REG_DWORD /d 0 /f

:: Disable Automatic Folder Discovery (Improves Responsiveness)
reg add "HKCU\Software\Classes\Local Settings\Software\Microsoft\Windows\Shell\Bags\AllFolders\Shell" /v "FolderType" /t REG_SZ /d "NotSpecified" /f

:: Hide Gallery From File Explorer and Set This PC as Default
reg add "HKCU\Software\Classes\CLSID\{e88865ea-0e1c-4e20-9aa6-edcd0212c87c}" /v System.IsPinnedToNameSpaceTree /t REG_DWORD /d 0 /f
reg add "HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\Advanced" /v LaunchTo /t REG_DWORD /d 1 /f

:: Use Full App Name on Desktop Shortcuts (Like Firefox not Firefox - Shortcut)
reg add "HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer\NamingTemplates" /v "ShortcutNameTemplate" /t REG_SZ /d "\"%%s.lnk\"" /f

:: Disable Location Services
reg add "HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Privacy" /v LocationServicesEnabled /t REG_DWORD /d 0 /f

:: Disable Input Personalization Settings
reg add "HKCU\SOFTWARE\Microsoft\Personalization\Settings" /v AcceptedPrivacyPolicy /t REG_DWORD /d 0 /f
reg add "HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\InputPersonalization" /v RestrictImplicitTextCollection /t REG_DWORD /d 1 /f
reg add "HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\InputPersonalization" /v RestrictImplicitInkCollection /t REG_DWORD /d 1 /f

:: Disable Automatic Feedback Sampling
reg add "HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Feedback" /v AutoSample /t REG_DWORD /d 0 /f
reg add "HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Feedback" /v ServiceEnabled /t REG_DWORD /d 0 /f

:: Disable "Let websites provide locally relevant content by accessing my language list"
reg add "HKCU\Control Panel\International\User Profile" /v HttpAcceptLanguageOptOut /t REG_DWORD /d 1 /f

:: Disable Background Apps
reg add "HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\BackgroundAccessApplications" /v GlobalUserDisabled /t REG_DWORD /d 1 /f

:: Disable App Diagnostics
reg add "HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\AppDiagnostics" /v AppDiagnosticsEnabled /t REG_DWORD /d 0 /f

:: Disable Delivery Optimization
reg add "HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\DeliveryOptimization" /v DODownloadMode /t REG_DWORD /d 0 /f

:: Disable Tablet Mode
reg add "HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\ImmersiveShell" /v TabletMode /t REG_DWORD /d 0 /f

:: Disable Use Sign-In Info for User Account
reg add "HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Authentication" /v UseSignInInfo /t REG_DWORD /d 0 /f

:: Disable Maps Auto Download
reg add "HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Maps" /v AutoDownload /t REG_DWORD /d 0 /f

:: Disable Telemetry and Ads
reg add "HKCU\SOFTWARE\Microsoft\Siuf\Rules" /v NumberOfSIUFInPeriod /t REG_DWORD /d 0 /f
reg add "HKCU\SOFTWARE\Policies\Microsoft\Windows\CloudContent" /v DisableTailoredExperiencesWithDiagnosticData /t REG_DWORD /d 1 /f
reg add "HKCU\SOFTWARE\Policies\Microsoft\Windows\CloudContent" /v DisableWindowsConsumerFeatures /t REG_DWORD /d 1 /f
reg add "HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\Advanced" /v ShowSyncProviderNotifications /t REG_DWORD /d 0 /f
reg add "HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\AdvertisingInfo" /v Enabled /t REG_DWORD /d 0 /f
reg add "HKCU\SOFTWARE\Microsoft\InputPersonalization\TrainedDataStore" /v "HarvestContacts" /t REG_DWORD /d 0 /f

:: Set Display for Performance
reg add "HKCU\Control Panel\Desktop" /v MenuShowDelay /t REG_DWORD /d 1 /f

:: On Shutdown, Windows will automatically close any running applications
reg add "HKCU\Control Panel\Desktop" /v AutoEndTasks /t REG_DWORD /d 1 /f

:: Sets the Mouse hover time to 400 milliseconds
reg add "HKCU\Control Panel\Mouse" /v MouseHoverTime /t REG_SZ /d "400" /f

:: Hides the Meet Now Button on the Taskbar
reg add "HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\Explorer" /v HideSCAMeetNow /t REG_DWORD /d 1 /f

:: Disable the Second Out-Of-Box Experience
reg add "HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\UserProfileEngagement" /v ScoobeSystemSettingEnabled /t REG_DWORD /d 0 /f

:: Set Registry Keys to Enable End Task With Right Click
reg add "HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\Advanced\TaskbarDeveloperSettings" /v TaskbarEndTask /t REG_DWORD /d 1 /f

:: Disable Notification Tray and Calendar
reg add "HKCU\Software\Policies\Microsoft\Windows\Explorer" /v DisableNotificationCenter /t REG_DWORD /d 1 /f
reg add "HKCU\Software\Microsoft\Windows\CurrentVersion\PushNotifications" /v ToastEnabled /t REG_DWORD /d 0 /f

:: Set Classic Right-Click Menu for Windows 11
reg add "HKCU\Software\Classes\CLSID\{86ca1aa0-34aa-4e8b-a509-50c905bae2a2}\InprocServer32" /ve /t REG_SZ /d "" /f

:: Disable Xbox GameDVR
reg add "HKCU\System\GameConfigStore" /v GameDVR_FSEBehavior /t REG_DWORD /d 2 /f
reg add "HKCU\System\GameConfigStore" /v GameDVR_Enabled /t REG_DWORD /d 0 /f
reg add "HKCU\System\GameConfigStore" /v GameDVR_DXGIHonorFSEWindowsCompatible /t REG_DWORD /d 1 /f
reg add "HKCU\System\GameConfigStore" /v GameDVR_HonorUserFSEBehaviorMode /t REG_DWORD /d 1 /f
reg add "HKCU\System\GameConfigStore" /v GameDVR_EFSEFeatureFlags /t REG_DWORD /d 0 /f

:: Disable Bing Search in Start Menu
reg add "HKCU\SOFTWARE\Policies\Microsoft\Windows\Explorer" /v DisableSearchBoxSuggestions /t REG_DWORD /d 1 /f

:: Enables NumLock on Startup
reg add "HKCU\Control Panel\Keyboard" /v InitialKeyboardIndicators /t REG_SZ /d 2 /f

:: Disable Sticky Keys
reg add "HKCU\Control Panel\Accessibility\StickyKeys" /v Flags /t REG_SZ /d "506" /f
reg add "HKCU\Control Panel\Accessibility\StickyKeys" /v HotkeyFlags /t REG_SZ /d "58" /f

:: Enables Show File Extensions
reg add "HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced" /v HideFileExt /t REG_DWORD /d 0 /f

:: Enables Dark Mode
reg add "HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Themes\Personalize" /v AppsUseLightTheme /t REG_DWORD /d 0 /f
reg add "HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Themes\Personalize" /v ColorPrevalence /t REG_DWORD /d 0 /f
reg add "HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Themes\Personalize" /v EnableTransparency /t REG_DWORD /d 1 /f
reg add "HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Themes\Personalize" /v SystemUsesLightTheme /t REG_DWORD /d 0 /f

:: Disable Last Access Time Stamp and Legacy 8.3 Char Length File Name Creation - This Can Improve File System Performance
fsutil behavior set disableLastAccess 1
fsutil behavior set disable8dot3 1

:: Restore Windows Photo Viewer and Set as Default Program for Image Files
:: Restore Windows Photo Viewer
reg add "HKCU\SOFTWARE\Classes\.bmp" /ve /d "PhotoViewer.FileAssoc.Tiff" /f
reg add "HKCU\SOFTWARE\Classes\.cr2" /ve /d "PhotoViewer.FileAssoc.Tiff" /f
reg add "HKCU\SOFTWARE\Classes\.dib" /ve /d "PhotoViewer.FileAssoc.Tiff" /f
reg add "HKCU\SOFTWARE\Classes\.gif" /ve /d "PhotoViewer.FileAssoc.Tiff" /f
reg add "HKCU\SOFTWARE\Classes\.ico" /ve /d "PhotoViewer.FileAssoc.Tiff" /f
reg add "HKCU\SOFTWARE\Classes\.jfif" /ve /d "PhotoViewer.FileAssoc.Tiff" /f
reg add "HKCU\SOFTWARE\Classes\.jpe" /ve /d "PhotoViewer.FileAssoc.Tiff" /f
reg add "HKCU\SOFTWARE\Classes\.jpeg" /ve /d "PhotoViewer.FileAssoc.Tiff" /f
reg add "HKCU\SOFTWARE\Classes\.jpg" /ve /d "PhotoViewer.FileAssoc.Tiff" /f
reg add "HKCU\SOFTWARE\Classes\.jxr" /ve /d "PhotoViewer.FileAssoc.Tiff" /f
reg add "HKCU\SOFTWARE\Classes\.png" /ve /d "PhotoViewer.FileAssoc.Tiff" /f
reg add "HKCU\SOFTWARE\Classes\.tif" /ve /d "PhotoViewer.FileAssoc.Tiff" /f
reg add "HKCU\SOFTWARE\Classes\.tiff" /ve /d "PhotoViewer.FileAssoc.Tiff" /f
reg add "HKCU\SOFTWARE\Classes\.wdp" /ve /d "PhotoViewer.FileAssoc.Tiff" /f

:: Create Relevant File Associations
reg add "HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\FileExts\.bmp\OpenWithProgids" /v "PhotoViewer.FileAssoc.Tiff" /t REG_NONE /f
reg add "HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\FileExts\.cr2\OpenWithProgids" /v "PhotoViewer.FileAssoc.Tiff" /t REG_NONE /f
reg add "HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\FileExts\.dib\OpenWithProgids" /v "PhotoViewer.FileAssoc.Tiff" /t REG_NONE /f
reg add "HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\FileExts\.gif\OpenWithProgids" /v "PhotoViewer.FileAssoc.Tiff" /t REG_NONE /f
reg add "HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\FileExts\.ico\OpenWithProgids" /v "PhotoViewer.FileAssoc.Tiff" /t REG_NONE /f
reg add "HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\FileExts\.jfif\OpenWithProgids" /v "PhotoViewer.FileAssoc.Tiff" /t REG_NONE /f
reg add "HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\FileExts\.jpe\OpenWithProgids" /v "PhotoViewer.FileAssoc.Tiff" /t REG_NONE /f
reg add "HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\FileExts\.jpeg\OpenWithProgids" /v "PhotoViewer.FileAssoc.Tiff" /t REG_NONE /f
reg add "HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\FileExts\.jpg\OpenWithProgids" /v "PhotoViewer.FileAssoc.Tiff" /t REG_NONE /f
reg add "HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\FileExts\.jxr\OpenWithProgids" /v "PhotoViewer.FileAssoc.Tiff" /t REG_NONE /f
reg add "HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\FileExts\.png\OpenWithProgids" /v "PhotoViewer.FileAssoc.Tiff" /t REG_NONE /f
reg add "HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\FileExts\.tif\OpenWithProgids" /v "PhotoViewer.FileAssoc.Tiff" /t REG_NONE /f
reg add "HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\FileExts\.tiff\OpenWithProgids" /v "PhotoViewer.FileAssoc.Tiff" /t REG_NONE /f
reg add "HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\FileExts\.wdp\OpenWithProgids" /v "PhotoViewer.FileAssoc.Tiff" /t REG_NONE /f

:: Disable Windows Recall on Copilot+ PC - Credit Britec09
reg add "HKCU\Software\Policies\Microsoft\Windows\WindowsAI" /f
reg add "HKCU\Software\Policies\Microsoft\Windows\WindowsAI" /v "DisableAIDataAnalysis" /t REG_DWORD /d 1 /f
reg add "HKCU\Software\Policies\Microsoft\Windows\Windows AI" /v "TurnOffSavingSnapshots" /t REG_DWORD /d 1 /f

:: Makes Taskbar Transparent in Windows 10
reg add "HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\Advanced" /v "TaskbarAcrylicOpacity" /t REG_DWORD /d 0 /f

:: Disable Wallpaper JPEG Quality Reduction in Windows 10 
reg add "HKCU\Control Panel\Desktop" /v "JPEGImportQuality" /t REG_DWORD /d 100 /f

:: Sets "When Windows Detects Communication Activity" under "System > Sound > More sound settings > Communications" to "Do Nothing"
reg add "HKCU\Software\Microsoft\Multimedia\Audio" /v "UserDuckingPreference" /t REG_DWORD /d 3 /f

:: Toggle On NumLock
powershell -ExecutionPolicy Bypass -command "$WshShell = New-Object -ComObject WScript.Shell; $WshShell.SendKeys('{NUMLOCK}')"

:: Enables User Account Control (Without Dimming Desktop)
reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System" /v EnableLUA /t REG_DWORD /d 1 /f
reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System" /v "PromptOnSecureDesktop" /t REG_DWORD /d "0" /f

:: Restart PC to Apply All Changes
shutdown /r -t 1
   ]]>
  </File>
 </Extensions>
</unattend>